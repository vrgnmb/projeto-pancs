(function(window,document,undefined){var tmConsole;function ContentValidator(){var $public=this;var $private={};$public.isFilledObject=function(entity){if(!entity||entity.constructor!==Object){return false;}for(var key in entity){return true;}return false;};$public.stringIsNotEmpty=function(string){if(typeof string!=="string"){return false;}return $private.trimString(string).length>0;};$private.trimString=function(string){return string.replace(/^(\s+)|(\s+)$/gm,"").replace(/\s+/gm," ");};$public.stringMatches=function(string,regexp){if(!$public.stringIsNotEmpty(string)){return false;}return regexp.test(string);};return $public;}function CookieUtils(){var $public=this;var $private={};$private.typeValidator=new TypeValidator();$public.getItem=function(name){if(!$private.typeValidator.isString(name)){return;}var cookie=document.cookie;var startIndex=cookie.indexOf(name+"=");if(startIndex===-1){return;}var middleIndex=cookie.indexOf("=",startIndex)+1;var endIndex=cookie.indexOf(";",middleIndex);if(endIndex===-1){endIndex=cookie.length;}return unescape(cookie.substring(middleIndex,endIndex));};$public.setItem=function(name,value,domain,expireDays,expireHours,expireMinutes){if(!$private.typeValidator.isString(name)){return false;}if(!$private.typeValidator.isString(value)){return false;}document.cookie=$private.createCookieString(name,value,domain,expireDays,expireHours,expireMinutes);};$private.createCookieString=function(name,value,domain,expireDays,expireHours,expireMinutes){var cookie=name+"="+value;if($private.hasExpirationTime(expireDays,expireHours,expireMinutes)){cookie+="; expires="+$private.getExpirationDate(expireDays,expireHours,expireMinutes)+"; path=/;";}if($private.typeValidator.isString(domain)){if(cookie.substr(cookie.length-1)!==";"){cookie+=";";}cookie+=" domain="+domain+";";}return cookie;};$private.hasExpirationTime=function(days,hours,minutes){if($private.isValidNumber(days)||$private.isValidNumber(hours)||$private.isValidNumber(minutes)){return true;}return false;};$private.isValidNumber=function(number){if(!isNaN(parseInt(number))&&parseInt(number)!==0){return true;}return false;};$private.getExpirationDate=function(days,hours,minutes){var exdate=new Date();if($private.isValidNumber(days)){exdate.setDate(exdate.getDate()+days);}if($private.isValidNumber(hours)){exdate.setHours(exdate.getHours()+hours);}if($private.isValidNumber(minutes)){exdate.setMinutes(exdate.getMinutes()+minutes);}return exdate.toGMTString();};$private.setCookie=function(value){document.cookie=value;};$public.removeItem=function(name,domain){$private.setCookie($private.createCookieString(name,"",domain,-100));};$public.getCookies=function(){return document.cookie;};}function Logs(){var $private={};var $public=this;$private.queryString=new QueryString();$private.typeValidator=new TypeValidator();$private.tmConsole=(typeof tmConsole!=="undefined"?tmConsole:undefined);$private.history={"warn":[],"error":[],"info":[],"debug":[],"log":[]};$public.getPrefix=function(prefix){return $private.prefix;};$public.setPrefix=function(prefix){if($private.typeValidator.isString(prefix)){$private.prefix="["+prefix+"] ";}};$public.warn=function(message,namTag,namespace,executionTime){if($public.consoleValidator($private.tmConsole)){$private.tmConsole.append(namTag,namespace,message,executionTime,"warn");}return $private.print(message,"warn");};$public.error=function(message,namTag,namespace,executionTime){if($public.consoleValidator($private.tmConsole)){$private.tmConsole.append(namTag,namespace,message,executionTime,"error");}return $private.print(message,"error");};$public.info=function(message){return $private.print(message,"info");};$public.debug=function(message){return $private.print(message,"debug");};$public.log=function(message,namTag,namespace,executionTime){if($public.consoleValidator($private.tmConsole)){$private.tmConsole.append(namTag,namespace,message,executionTime,"success");}return $private.print(message,"log");};$public.consoleValidator=function(tmConsole){if(!tmConsole){return false;}if(!$private.typeValidator.isFunction(tmConsole.append)){return false;}return true;};$private.print=function(msg,fn){if(!$private.prefix){return;}if(!$private.typeValidator.isString(msg)){return;}msg=$private.prefix+msg;$public.setHistory(fn,msg);if($public.isActive()===false||!$private.hasConsole()){return;}return $private.runLogMethod(fn,msg);};$public.isActive=function(){if($private.queryString.getValue("tm")==="debug"){return true;}return false;};$public.getHistory=function(methodName){if($private.typeValidator.isArray($private.history[methodName])){return $private.history[methodName];}return;};$public.setHistory=function(fn,msg){if($private.typeValidator.isString(msg)&&$private.typeValidator.isArray($private.history[fn])){$private.history[fn].push(msg);}};$private.hasConsole=function(){if(!$private.typeValidator.isDefined($public.getConsole())){return false;}if(!$private.typeValidator.isDefined($public.getConsoleLog())){return false;}return true;};$public.getConsole=function(){return window.console;};$public.getConsoleLog=function(){return $public.getConsole().log;};$private.runLogMethod=function(fn,msg){if($private.typeValidator.isDefined($public.getConsole()[fn])){$public.getConsole()[fn](msg);return fn;}window.console.log(msg);return"log";};}function NameSpace(packageName){var $private={};var $public=this;$private.version="${project.version}";$private.validator=new TypeValidator();$public.init=function(packageName){if($private.validator.isString(packageName)){return $public.create(packageName);}};$public.create=function(packageName){$private.createUOLPD();$private.createTagManager();return $private.createPackage(packageName);};$private.createUOLPD=function(){if(!$private.validator.isObject(window.UOLPD)){window.UOLPD={};}};$private.createTagManager=function(){if(!$private.validator.isObject(UOLPD.TagManager)&&!$private.validator.isFunction(UOLPD.TagManager)&&typeof UOLPD.TagManager!=="object"){UOLPD.TagManager={};}};$private.createPackage=function(packageName){if(!$private.validator.isString(packageName)){return UOLPD.TagManager;}if(!$private.validator.isObject(UOLPD.TagManager[packageName])){UOLPD.TagManager[packageName]={};}UOLPD.TagManager[packageName].version=$private.version;if(!$private.validator.isArray(UOLPD.TagManager[packageName].config)){UOLPD.TagManager[packageName].config=[];}if(!$private.validator.isObject(UOLPD.TagManager[packageName].log)){UOLPD.TagManager[packageName].log=new Logs();UOLPD.TagManager[packageName].log.setPrefix("UOLPD.TagManager."+packageName);}return UOLPD.TagManager[packageName];};return $public.init(packageName);}function QueryString(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$public.getValue=function(name){if(!$private.queryStrings){return;}return $private.queryStrings[name];};$public.getQueryStrings=function(){return $private.queryStrings;};$public.setValues=function(){if(!$private.typeValidator.isString($public.getSearch())){return;}var substrings=$public.getSearch().substring(1).split("&");if(!$private.typeValidator.isArray(substrings)){return;}if(substrings.length===0){return;}for(var i=0,length=substrings.length;i<length;i++){if($private.typeValidator.isString(substrings[i])){$private.addQueryString(substrings[i]);}}};$public.getSearch=function(){return window.location.search;};$private.addQueryString=function(substring){var queryObject=$private.getQueryObject(substring);if(!queryObject){return;}$private.queryStrings=$private.queryStrings||{};$private.queryStrings[queryObject.key]=queryObject.value;};$private.getQueryObject=function(substring){var query=substring.split("=");if(!$private.typeValidator.isString(query[0])){return;}var result={"key":query[0],"value":"true"};if($private.typeValidator.isString(query[1])){result.value=query[1];}return result;};$public.setValues();}function RemoteStorage(){var $private={};var $public=this;$public.logs=new Logs();$public.logs.setPrefix("UOLPD.TagManager");$private.validator=new TypeValidator();$private.path="https://tm.uol.com.br/mercurio.html";$private.iframe=undefined;$private.iframeLoaded=false;$private.queue=[];$private.requests={};$public.init=function(){$private.hasLoaded(function(){$private.iframe=$private.getIframe($private.path);if(!$private.iframe){$private.setIframe();}if($private.iframe.getAttribute("data-loaded")==="true"){$private.iframeLoaded=true;}$private.setListener($private.iframe);return true;});return $public;};$private.getIframe=function(src){return document.querySelector('iframe[src*="'+src+'"]');};$public.get=function(key,callback,dataType){$private.communicator("get",key,undefined,callback,dataType);};$public.set=function(key,value,callback,dataType){$private.communicator("set",key,value,callback,dataType);};$public.removeItem=function(key,callback,dataType){callback=callback||function(){};$private.communicator("removeItem",key,undefined,callback,dataType);};$private.hasLoaded=function(fn,timeout){timeout=(timeout?timeout+10:10);if(typeof fn!="function"){return false;}if(document.body!==null){fn();return true;}window.setTimeout(function(){$private.hasLoaded(fn,timeout);},timeout);};$private.setIframe=function(){$private.iframe=$private.buildIframe();};$private.buildIframe=function(){var iframe=document.createElement("iframe");iframe.setAttribute("src",$private.path);iframe.setAttribute("id","tm-remote-storage");iframe.setAttribute("style","position:absolute;width:1px;height:1px;left:-9999px;display:none;");document.body.appendChild(iframe);return iframe;};$private.setListener=function(iframe){var hasEventListener=(window.addEventListener!==undefined);var method=(hasEventListener)?"addEventListener":"attachEvent";var message=(hasEventListener)?"message":"onmessage";var load=(hasEventListener)?"load":"onload";iframe[method](load,$private.iframeLoadHandler);window[method](message,$private.messageHandler);return iframe;};$private.iframeLoadHandler=function(event){event.target.setAttribute("data-loaded","true");$private.iframeLoaded=true;if(!$private.queue.length){return;}for(var i=0,length=$private.queue.length;i<length;i++){$private.sendMessageToIframe($private.queue[i]);}$private.queue=[];};$private.messageHandler=function(event){try{var data=JSON.parse(event.data);$private.requests[data.id].callback(data.key,data.value);delete $private.requests[data.id];}catch(err){}};$private.communicator=function(method,key,value,callback,dataType){if(!$private.validator.isString(key)){$public.logs.warn("Ocorreu um erro ao requisitar os dados");return;}if(method==="set"&&value===undefined){$public.logs.warn("Ocorreu um erro ao requisitar os dados");return;}if(!$private.validator.isFunction(callback)){$public.logs.warn("Ocorreu um erro ao requisitar os dados");return;}var request={id:(Math.round(Math.random()*9000000)),key:key,method:method,dataType:dataType};if(value){request.value=value;}var data={request:request,callback:callback};if($private.iframeLoaded){$private.sendMessageToIframe(data);}else{$private.queue.push(data);}if(!$private.iframe){$public.init();}};$private.sendMessageToIframe=function(data){$private.requests[data.request.id]=data;data=JSON.stringify(data.request);if(!data){return;}if($private.iframe&&$private.iframe.contentWindow){$private.iframe.contentWindow.postMessage(data,$private.path);}};return $public.init();}function Schema(configSchema){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$private.contentValidator=new ContentValidator();$public.__constructor=function(configSchema){if(!$private.typeValidator.isObject(configSchema)){return;}if(!$private.typeValidator.isObject(configSchema.properties)){return;}if(!$private.isValidRequired(configSchema)){return;}$private.configSchema={};$private.configSchema.required=[];$private.setProperties(configSchema.properties);if(configSchema.required.length>0){$private.configSchema.required=configSchema.required;}return $public;};$public.isValid=function(config){if(!$private.configSchema){return false;}if(!$private.typeValidator.isObject(config)){$public.invalidProperties=$private.configSchema.required;return false;}if(!$private.contentValidator.isFilledObject(config)){$public.invalidProperties=$private.configSchema.required;return false;}return $private.areValidProperties(config);};$private.isValidRequired=function(configSchema){if(!$private.typeValidator.isArray(configSchema.required)){return false;}for(var i=0,length=configSchema.required.length;i<length;i++){var required=configSchema.required[i];if(!$private.typeValidator.isString(required)){return false;}if(!configSchema.properties[required]){return false;}}return true;};$private.setProperties=function(properties){$private.configSchema.properties=$private.configSchema.properties||{};for(var key in properties){var property=$private.getProperty(properties[key]);if(property){$private.configSchema.properties[key]=property;}}};$private.getProperty=function(property){var result={};if($private.typeValidator.isRegExp(property)){return{"validator":$private.contentValidator.stringMatches,"modifier":property};}if(!$private.typeValidator.isString(property)){return;}property=property.split(/\|(.+)?/,2);var validator=$private.getValidator(property);if(!validator){return;}result.validator=validator;if(property[1]){result.modifier=$private.getModifier(property[1]);}return result;};$private.getValidator=function(property){if(property.length===1){return $private.typeValidator[property[0]];}return $private.contentValidator[property[0]];};$private.getModifier=function(modifier){if(!modifier){return;}try{return eval(modifier);}catch(e){}};$private.areValidProperties=function(config){var isValid=true;var requiredProperties=0;for(var property in config){if(!$private.isValidProperty(property,config)){isValid=false;}if($private.isRequiredProperty(property)){requiredProperties++;}}if(requiredProperties!==$private.configSchema.required.length){$private.countRequiredProperties(config);return false;}return isValid;};$private.isValidProperty=function(property,config){var propertyValidator=$private.configSchema.properties[property];if(!propertyValidator){return false;}if(!propertyValidator.validator(config[property],propertyValidator.modifier)){$private.addInvalidProperty(property);return false;}return true;};$private.getPropertyValidator=function(property){var item=$private.configSchema.properties[property];if(!$private.typeValidator.isString(item)){return;}item=item.split(/\|(.+)?/,2);var validator=$private.typeValidator[item[0]];if(!validator){return;}var contentValidator=$private.contentValidator[item[1]];if(!contentValidator){return;}return{"validator":validator,"contentValidator":contentValidator};};$private.validateContent=function(property,contentValidator){try{return contentValidator(property,eval(contentValidator));}catch(e){}};$private.isRequiredProperty=function(property){if($private.configSchema.required.length===0){return false;}for(var i=0,length=$private.configSchema.required.length;i<length;i++){var required=$private.configSchema.required[i];if(required===property){return true;}}return false;};$private.addInvalidProperty=function(property){if(!$public.invalidProperties){$public.invalidProperties=[];}if(!$private.arrayHasItem($public.invalidProperties,property)){$public.invalidProperties.push(property);}};$private.arrayHasItem=function(array,item){for(var i=0,length=array.length;i<length;i++){if(array[i]==item){return true;}}return false;};$private.countRequiredProperties=function(config){for(var i=0,length=$private.configSchema.required.length;i<length;i++){var required=$private.configSchema.required[i];if(!$private.typeValidator.isDefined(config[required])){$private.addInvalidProperty(required);}}};return $public.__constructor(configSchema);}function ScriptUtils(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$private.dataCalls="data-uoltm-calls";$public.hasTagScript=function(src){if(!$private.typeValidator.isString(src)){return false;}if(src.length===0){return false;}if($public.findScript($private.removeProtocol(src))){return true;}return false;};$private.removeProtocol=function(value){return value.replace(/(^\/\/|^http:\/\/|^https:\/\/)/,"");};$public.findScript=function(src){return document.querySelector('script[src*="'+src+'"]');};$private.isSrcEqual=function(src1,src2){return(src1.indexOf(src2)>-1);};$public.createScript=function(src){if(!$private.typeValidator.isString(src)){return;}var tag=document.createElement("script");tag.setAttribute("src",src);tag.async=true;return tag;};$public.appendTag=function(script){if(!$private.typeValidator.isDefined(script)){return;}if(script.constructor===HTMLScriptElement){$private.lastScriptsParent().appendChild(script);return true;}};$private.lastScriptsParent=function(){return document.getElementsByTagName("script")[0].parentNode;};$public.createSyncScript=function(src){if(!$private.typeValidator.isString(src)){return;}document.write("<scr"+'ipt src="'+src+'"></scr'+"ipt>");};}function StringUtils(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$public.trim=function(value){if(!$private.typeValidator.isString(value)){return;}if(value.length===0){return;}value=value.replace(/^(\s+)|(\s+)$/gm,"").replace(/\s+/gm," ");return value;};$public.getValueFromKeyInString=function(str,name,separator){if(!$private.typeValidator.isString(name)||name.length===0){return;}if(!$private.typeValidator.isString(str)||str.length===0){return;}if(!$private.typeValidator.isString(separator)||separator.length===0){return;}if(str.substring(str.length-1)){str+=separator;}name+="=";var startIndex=str.indexOf(name);if(startIndex===-1){return"";}var middleIndex=str.indexOf("=",startIndex)+1;var endIndex=str.indexOf(separator,middleIndex);if(endIndex===-1){endIndex=str.length;}return unescape(str.substring(middleIndex,endIndex));};return $public;}function TrackManager(){var $private={};var $public=this;$private.API_URL="//logger.uol.com.br/v1/?prd=98&gps=true&disp=true&mm=true";$private.typeValidator=new TypeValidator();$private.scriptUtils=new ScriptUtils();$private.baseMetric={groupingMap:{},measureMap:{}};$private.raffledRate=Math.round(Math.random()*100);$private.samplingRate=2;$public.trackSuccess=function(msr,samplingRate){var sampling=$private.generateSamplingRate(samplingRate);$public.addMetrics($private.getMeasures(msr),null,sampling);};$private.generateSamplingRate=function(samplingRate){if($private.typeValidator.isNumber(samplingRate)){return samplingRate;}return $private.samplingRate;};$public.addMetrics=function(measures,groupings,samplingRate){if(!$private.isTrackEnabled(samplingRate)){return;}var metric=$private.generateMetric(measures,groupings);if(!metric){return;}$private.createNamespaceMetrics();window.UOLPD.TagManager.metrics.push(metric);$private.triggerMetrics();};$private.isTrackEnabled=function(samplingRate){try{if(window.localStorage.getItem("trackManager")=="true"){return true;}}catch(e){}if($public.getRaffledRate()<=samplingRate){return true;}return false;};$public.getRaffledRate=function(){return $private.raffledRate;};$private.generateMetric=function(measures,groupings){var metric=JSON.parse(JSON.stringify($private.baseMetric));if($private.typeValidator.isObject(measures)){metric.measureMap=metric.measureMap||{};for(var msr in measures){metric.measureMap[msr]=measures[msr];}}if($private.typeValidator.isObject(groupings)){metric.groupingMap=metric.groupingMap||{};for(var grp in groupings){metric.groupingMap[grp]=groupings[grp];}}if(Object.keys(metric.measureMap).length<1){return;}return metric;};$private.createNamespaceMetrics=function(){window.UOLPD=window.UOLPD||{};window.UOLPD.TagManager=window.UOLPD.TagManager||{};window.UOLPD.TagManager.metrics=window.UOLPD.TagManager.metrics||[];};$private.triggerMetrics=function(){if(window.UOLPD.TagManager.trackTimeWindow){return;}window.UOLPD.TagManager.trackTimeWindow=setTimeout(function(){var xhr=new XMLHttpRequest();xhr.open("POST",$private.API_URL,true);xhr.setRequestHeader("Content-Type","application/json; charset=UTF-8");xhr.send(JSON.stringify(window.UOLPD.TagManager.metrics));window.UOLPD.TagManager.metrics=[];clearTimeout(window.UOLPD.TagManager.trackTimeWindow);window.UOLPD.TagManager.trackTimeWindow=undefined;},4000);};$private.getMeasures=function(msr,value,measure){if(!$private.typeValidator.isString(msr)){return measure;}if(!value){value="1";}if($private.typeValidator.isNumericString(value)||$private.typeValidator.isNumber(value)){measure=measure||{};measure[msr]=value;}return measure;};$public.getModuleName=function(moduleName){return $private.moduleName;};$public.setModuleName=function(moduleName){if($private.typeValidator.isString(moduleName)){$private.moduleName="TM-"+moduleName;}$private.baseMetric.groupingMap=$private.baseMetric.groupingMap||{};$private.baseMetric.groupingMap.tm_repo_id=$public.getRepoId();$private.baseMetric.groupingMap.Origem=$private.moduleName;};$public.getRepoId=function(){return"37d0mn";};$public.trackError=function(errorType,errorEffect){var errorGroups=$private.getGroups("erro_tipo",errorType);if(!$private.typeValidator.isObject(errorGroups)){return;}errorGroups=$private.getGroups("erro_efeito",errorEffect,errorGroups);if(!$private.typeValidator.isObject(errorGroups)){return;}$public.addMetrics($private.getMeasures("Erros"),errorGroups,100);};$private.getGroups=function(grp,value,groups){if(!$private.typeValidator.isString(grp)){return;}if(!$private.typeValidator.isString(value)&&!$private.typeValidator.isNumber(value)){return;}groups=groups||{};groups[grp]=value;return groups;};$public.trackCustom=function(measure,trackType,trackValue,samplingRate){var metricMeasures=$private.getMeasures(measure);var metricsGroups=$private.getGroups(trackType,trackValue);if(!metricMeasures||!metricsGroups){return;}var sampling=$private.generateSamplingRate(samplingRate);$public.addMetrics(metricMeasures,metricsGroups,sampling);};$public.trackCustomObj=function(metrics,samplingRate){if(!$private.typeValidator.isObject(metrics)||!$private.typeValidator.isObject(metrics.measures)){return;}var measures,groups;measures={};for(var msr in metrics.measures){measures=$private.getMeasures(msr,metrics.measures[msr],measures);}if(!$private.isValidMeasures(measures)){return;}if($private.typeValidator.isObject(metrics.groups)){groups={};for(var grp in metrics.groups){groups=$private.getGroups(grp,metrics.groups[grp],groups);}}var sampling=$private.generateSamplingRate(samplingRate);$public.addMetrics(measures,groups,sampling);};$private.isValidMeasures=function(measures){if(Object.keys(measures).length<1){return false;}var isValid=false;for(var msr in measures){if(measures[msr]==1||measures[msr]=="1"){isValid=true;}}return isValid;};}function TypeValidator(){var $public=this;var $private={};$private.contentValidator=new ContentValidator();$public.isDefined=function(value){return value!==undefined&&value!==null;};$public.isString=function(value){return $private.contentValidator.stringIsNotEmpty(value);};$public.isArray=function(value){return value&&value.constructor.toString()===Array.toString();};$public.isObject=function(entity){return entity&&entity.constructor.toString()===Object.toString();};$public.isFunction=function(value){return value!==undefined&&value.constructor.toString()===Function.toString();};$public.isNumber=function(value){return Number(value)===value;};$public.isInt=function(value){return $public.isNumber(value)&&value%1===0;};$public.isRegExp=function(value){return value!==undefined&&value.constructor.toString()===RegExp.toString();};$public.isNumericString=function(value){return $public.isString(value)&&!isNaN(value);};$public.isBoolean=function(value){return value!==undefined&&value.constructor.toString()==Boolean.toString();};return $public;}var uolpdCommons=new NameSpace("Commons");uolpdCommons.RemoteStorage=RemoteStorage;(function(window,document,undefined){function DataLayerPersistence(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$public.remoteStorage=new RemoteStorage();$public.logger=new Logs();$private.trackManager=new TrackManager();$public.__constructor=(function(){$public.logger.setPrefix("UOLPD.TagManager.TailtargetTrack");$private.trackManager.setModuleName("tailtarget-track");$private.tailtarget={};})();$public.getNameSpace=function(nameSpace){return $private.nameSpace;};$public.setNameSpace=function(nameSpace){if($private.typeValidator.isString(nameSpace)){$private.nameSpace=nameSpace;}};$public.addAttribute=function(key,value){if(!$private.typeValidator.isDefined($private.nameSpace)){return false;}if(!$private.typeValidator.isString(key)){return false;}value=$private.formatValue(value);if(!$private.typeValidator.isString(value)){return false;}$private.storeKeyValue($private.formatKey(key),value);return true;};$private.formatValue=function(value){if($private.typeValidator.isArray(value)){return value.join(",");}return value;};$private.storeKeyValue=function(key,value){$private.tailtarget[$private.formatKey(key)]=value;};$private.formatKey=function(key){if(key==="getProfiles"){return"tt_cluster";}return key.replace("get","tt_").toLowerCase();};$public.persist=function(){if($private.hasAttributes($private.tailtarget)){$public.remoteStorage.get("uolDataLayer",function(key,value){var dataLayer;try{dataLayer=JSON.parse(value)||{};}catch(e){dataLayer={};}dataLayer[$private.nameSpace]=$private.tailtarget;$public.remoteStorage.set(key,JSON.stringify(dataLayer),$private.dataLayerCallback);try{window.localStorage.setItem(key,JSON.stringify(dataLayer));}catch(err){}});}};$private.hasAttributes=function(obj){if(!$private.typeValidator.isObject(obj)){return false;}for(var key in obj){return true;}return false;};$private.dataLayerCallback=function(){$public.logger.debug("Persistindo os dados da TailTarget na dataLayer");};$public.clearData=function(){$public.remoteStorage.get("uolDataLayer",function(key,value){var dataLayer;try{dataLayer=JSON.parse(value);delete dataLayer[$private.nameSpace];}catch(e){}$public.remoteStorage.set(key,JSON.stringify(dataLayer),$private.dataLayerCallback);});};}function Identify(){var $private={};var $public=this;$public.logger=new Logs();$public.trackManager=new TrackManager();$private.remoteStorage=new RemoteStorage();$private.typeValidator=new TypeValidator();$private.scriptUtils=new ScriptUtils();$public.dataLayerPersistence=new DataLayerPersistence();$public.scripts=["//tm.jsuol.com.br/modules/external/tailtarget/profiles.js","//tm.jsuol.com.br/modules/external/tailtarget/t3m/"];$public.__constructor=(function(){$public.logger.setPrefix("UOLPD.TagManager.TailtargetTrack");$public.trackManager.setModuleName("tailtarget-track");$private.storageName="tailtarget";$public.dataLayerPersistence.setNameSpace("TailtargetTrack");})();$public.init=function(config,namTag,namespace){$private.namTag=namTag;$private.namespace=namespace;$private.timeStampInit=Date.now();$private.config=config||{};$public.trackManager.trackSuccess("Execucoes Iniciadas");$private.cookieUtils=new CookieUtils($private.namTag,$private.namespace,$private.timeStampInit);if($public.isOptOutEnabled()){$public.dataLayerPersistence.clearData();$private.trackError("opt-out-enabled",'O usuário ativou a funcionalidade de opt-out nas <a href="https://sac.uol.com.br/#/wrapper?url=https:%2F%2Fsac.uol.com.br%2Finfo%2Fprotecao_privacidade%2Fnormas_protecao_privacidade.jhtm">opções de publicidade</a>');return;}if(window.top!==window.self){$private.trackError("plugin-on-iframe","O plugin não irá inserir o script pois está em um iframe");}else{$private.createScripts();$public.persistData();}};$public.isOptOutEnabled=function(){return $private.cookieUtils.getItem("BTOPTOUT")==="1";};$private.trackError=function(errorType,errorMessage){var isValidErrorType=$private.typeValidator.isString(errorType);var isValidErrorMessage=$private.typeValidator.isString(errorMessage);if(!isValidErrorType||!isValidErrorMessage){return;}$public.logger.warn(errorMessage,$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError(errorType,"fluxo_interrompido");};$private.calculateTimeSpent=function(timeStampInit){if(!$private.typeValidator.isDefined(timeStampInit)){return Date.now()-$private.timeStampInit;}return Date.now()-timeStampInit;};$private.createScripts=function(){var isServiceEnabled=false;$private.loadingScripts=0;if(!$private.typeValidator.isString($private.config.tailtargetId)){$private.config.tailtargetId="TT-10162-1/CT-10";}if($private.config.tailtargetId=="TT-10162-1/CT-10"||$private.config.tailtargetId=="TT-12340-4/CT-929"){$public.scripts[1]+=$private.config.tailtargetId+".js";}else{$public.scripts[1]="//tags.t.tailtarget.com/t3m.js?i="+$private.config.tailtargetId;}for(var i=0,length=$public.scripts.length;i<length;i++){var url=$public.scripts[i];if($private.scriptUtils.hasTagScript(url)){$private.trackError("fluxo_interrompido","O script "+window.location.protocol+url+" já existe na página");return;}if(!isServiceEnabled){$private.enableServices();isServiceEnabled=true;}var script=$private.scriptUtils.createScript(url);script.addEventListener("load",$private.handleLoadingScripts);script.addEventListener("error",$private.handleLoadingScripts);$private.loadingScripts++;$private.scriptUtils.appendTag(script);}$private.loadInit=Date.now();$private.executionTime=$private.calculateTimeSpent();};$private.handleLoadingScripts=function(){var thirdPartyOwner=this.src.indexOf("profiles")>=0?"Profiles":"T3m";$private["loadTime"+thirdPartyOwner]=$private.calculateTimeSpent($private.loadInit);if(--$private.loadingScripts===0){$private.loadTime=$private["loadTime"+thirdPartyOwner];$private.thirdPartyInit=Date.now();}};$private.enableServices=function(){window._ttprofiles=window._ttprofiles||[];var profiles=[["_setAccount",$private.config.tailtargetId.split("/")[0]],["_sync",false],["_enableServices"]];for(var i=0;i<profiles.length;i++){try{window._ttprofiles.push(profiles[i]);}catch(e){}}};$public.persistData=function(){try{window.localStorage.removeItem("tailtarget");window.localStorage.removeItem("tailtargettrack");$private.remoteStorage.removeItem("tailTarget");}catch(e){}var times=0;var ttProfilesInterval=window.setInterval(function(){times++;var profiles=$private.getValidProfiles(window._ttprofiles);if(($private.typeValidator.isDefined(profiles)&&$private.typeValidator.isNumber($private.loadTime))||times>=210){$private.persistAttributes(profiles);window.clearInterval(ttProfilesInterval);$private.thirdPartyExecutionTime=$private.calculateTimeSpent($private.thirdPartyInit);$private.trackMetrics();}},150);$public.logger.log("O plugin foi configurado corretamente e foi executado com sucesso",$private.namTag,$private.namespace,((new Date()).getTime()-$private.timeStampInit));$public.trackManager.trackSuccess("Execucoes Finalizadas");};$private.getValidProfiles=function(ttprofiles){var tailtarget={};var length=0;if(!ttprofiles){return;}for(var key in ttprofiles){if(!$private.isValidKey(key)){continue;}if(!ttprofiles[key].length){continue;}tailtarget[key]=ttprofiles[key];length++;}if(length===0){return;}return tailtarget;};$private.isValidKey=function(key){var validKeys=["getAge","getGender","getProfiles","getSubjects","getTeam","getSocialClass","getMicrosegments","getLists","getCustomAudience"];for(var i=0;i<validKeys.length;i++){if(key==validKeys[i]){return true;}}return false;};$private.persistAttributes=function(profiles){for(var key in profiles){$public.dataLayerPersistence.addAttribute(key,profiles[key]);}$public.dataLayerPersistence.persist();};$private.trackMetrics=function(){if(typeof $private.executionTime=="number"&&typeof $private.loadTime=="number"&&typeof $private.loadTimeProfiles=="number"&&typeof $private.loadTimeT3m=="number"&&typeof $private.thirdPartyExecutionTime=="number"){$public.trackManager.trackCustomObj($private.getMetrics());}};$private.getMetrics=function(){var metrics={};metrics.measures={};metrics.groups={};metrics.measures.executionTime=$private.executionTime;metrics.measures.LoadTime=$private.loadTime;metrics.measures.LoadTimeProfiles=$private.loadTimeProfiles;metrics.measures.LoadTimeT3m=$private.loadTimeT3m;metrics.measures.ThirdPartyExecutionTime=$private.thirdPartyExecutionTime;$private.addTime(metrics);return metrics;};$private.addTime=function(metrics){if($private.isOutsideTime(metrics.measures.executionTime,1000)||$private.isOutsideTime(metrics.measures.LoadTime,21000)||$private.isOutsideTime(metrics.measures.ThirdPartyExecutionTime,21000)){metrics.measures.OutsideTime=1;metrics.groups.groupType=2;}else{metrics.measures.Execution=1;metrics.groups.groupType=1;}};$private.isOutsideTime=function(time,max){if(time<0){return true;}if(time>max){return true;}return false;};}var __monitoracaoJsuol="tm.jsuol.com.br/modules/tailtarget-track.js";var nameSpace=new NameSpace("TailtargetTrack");nameSpace.RemoteStorage=new RemoteStorage();nameSpace.init=function(config,namTag){return(new Identify()).init(config,namTag,"TailtargetTrack");};})(window,document);(function(window,document,undefined){function Injector(){var $private={};var $public=this;$public.logger=new Logs();$public.logger.setPrefix("UOLPD.TagManager.CodeInjector");$public.trackManager=new TrackManager();$public.trackManager.setModuleName("code-injector");$public.codes=[];$private.typeValidator=new TypeValidator();$public.init=function(config,namTag,namespace){$private.timeStampInit=Date.now();$private.namTag=namTag;$private.namespace=namespace;$public.trackManager.trackSuccess("Execucoes Iniciadas");if($private.isValidConfig(config)){$private.evalCode($private.trimScriptTag(config.codeInjector));}};$private.isValidConfig=function(config){if(!$private.typeValidator.isObject(config)){$private.trackError("config_invalido","Uma configuração do Tag Manager não está implementada corretamente");return false;}if(!$private.typeValidator.isString(config.codeInjector)){$private.trackError("config_invalido","Uma configuração do Tag Manager não está implementada corretamente");return false;}return true;};$private.trackError=function(errorType,errorMessage){if(!$private.typeValidator.isString(errorType)){return;}if(!$private.typeValidator.isString(errorMessage)){return;}$public.logger.warn(errorMessage,$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError(errorType,"fluxo_interrompido");};$private.calculateTimeSpent=function(timeStampInit){if(!$private.typeValidator.isDefined(timeStampInit)){return Date.now()-$private.timeStampInit;}return Date.now()-timeStampInit;};$private.trimScriptTag=function(code){var replaceScriptRegex=/^(\s+)?<script>(\s+)?|(\s+)?<\/script>(\s+)?$/gm;code=code.replace(replaceScriptRegex,"");$public.codes.push(code);return code;};$private.evalCode=function(code){try{var dynMet=new Function(code);dynMet();$public.logger.log("Tag do CodeInjector executada com sucesso",$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackSuccess("Execucoes Finalizadas");$public.trackManager.trackCustomObj($private.getExecutionMetrics());}catch(err){$private.trackError("parse_error","O Tag Manager previniu um erro de execução de javascript. Favor verificar a implementação de sua tag");}};$private.getExecutionMetrics=function(){var metrics={};metrics.measures={};metrics.groups={};metrics.groups.groupType=1;metrics.measures.executionTime=$private.calculateTimeSpent();metrics.measures.Execution=1;if(metrics.measures.executionTime<0||metrics.measures.executionTime>1000){delete metrics.measures.Execution;metrics.groups.groupType=2;metrics.measures.OutsideTime=1;}return metrics;};}var nameSpace=new NameSpace("CodeInjector");nameSpace.init=function(config,namTag){return(new Injector()).init(config,namTag,"CodeInjector");};})(window,document);(function(window,document,undefined){function Sesame(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$private.trackManager=new TrackManager();$private.trackManager.setModuleName("Sesame");$public.logger=new Logs();$public.logger.setPrefix("UOLPD.TagManager.Sesame");$private.googleTopUrl="//pagead2.googlesyndication.com/pagead/js/google_top.js";$private.presentElements=["video",'object[value="mais.uol"]','object[src="mais.uol.com.br"]','object[data="mais.uol.com.br"]'];$public.init=function(namTag,namespace){$private.namTag=namTag;$private.namespace=namespace;$private.timeStampInit=(new Date()).getTime();$private.trackManager.trackSuccess("Execucoes Iniciadas");var interval=window.setInterval(function(){if(document.readyState&&document.readyState=="complete"){window.clearInterval(interval);$private.includeSesame();}},100);};$private.includeSesame=function(){if(!$private.hasVideoOrObject()){$private.trackError("invalid_element","O elemento que utilizará o Sesame não é válido");return;}if(!$private.hasElement("iframe[id=google_top]")){$public.appendElement($public.createIframe());}if(!$private.hasElement('script[src*="'+$private.googleTopUrl+'"]')){$public.appendElement($public.createTagScript());}$public.logger.log("O plugin foi executado corretamente",$private.namTag,$private.namespace,((new Date()).getTime()-$private.timeStampInit));$private.trackManager.trackSuccess("Execucoes Finalizadas");};$private.hasVideoOrObject=function(){for(var i=0;i<$private.presentElements.length;i++){if($private.hasElement($private.presentElements[i])){return true;}}return false;};$private.hasElement=function(query){var result=document.querySelectorAll(query);if(result.length===1){return true;}return false;};$public.appendElement=function(element){if(!element){$private.trackError("invalid_element","O elemento que utilizará o Sesame não foi encontrado");return;}document.body.appendChild(element);};$public.createIframe=function(){var iframe=document.createElement("iframe");iframe.setAttribute("data-video-ads","true");iframe.setAttribute("id","google_top");iframe.setAttribute("name","google_top");iframe.setAttribute("style","display:none;");return iframe;};$public.createTagScript=function(){var script=document.createElement("script");script.setAttribute("src",$private.googleTopUrl);return script;};$private.trackError=function(errorType,errorMessage){if(!$private.typeValidator.isString(errorType)){return;}if(!$private.typeValidator.isString(errorMessage)){return;}$public.logger.warn(errorMessage,$private.namTag,$private.namespace,((new Date()).getTime()-$private.timeStampInit));$private.trackManager.trackError(errorType,"fluxo_interrompido");};}var __monitoracaoJsuol="tm.jsuol.com.br/modules/sesame.js";var namespace=new NameSpace("Sesame");namespace.init=function(config,namTag){return(new Sesame()).init(namTag,"Sesame");};})(window,document);(function(window,document,undefined){var DfpSchema={properties:{bannerId:"isString",fluid:"isArray",bannerWidth:"isNumericString",bannerHeight:"isNumericString",dfppath:"isString",forcePath:"isArray",campaignuol:"isString",sizeMapping:"isString",pos:"isString",expble:"isNumericString",group:"isString",keyword:"isString",isCompanion:"isString",outOfPage:"isArray",rotative:"isNumericString",hide:"isString",isIncremental:"isString",frequencyControl:"isArray",deslabel:"isString",nativeType:"isNumericString",requestDelay:"isNumericString",timeToRefresh:"isNumericString",customTargetings:"isString",geolocation:"isString"},required:["bannerId","fluid","forcePath","outOfPage","hide","frequencyControl","isCompanion","geolocation"]};function TimeoutUtils(callback,delay){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$private.remaining=delay;$private.isCalling=false;$public.getTimeout=function(){return $private.timeout;};$public.getRemaining=function(){return $private.remaining;};$public.getDelay=function(){return delay;};$public.getStartTime=function(){return $private.startTime;};$public.play=function(){if(!$private.isValidTimeout()){return;}$private.startTime=Date.now();if(!$private.typeValidator.isNumber($private.remaining)){$private.remaining=$private.delay;}if($private.isCalling){return;}if($private.remaining<1){return;}$private.timeout=window.setTimeout($private.timeoutCallback,$private.remaining);$private.isCalling=true;};$private.timeoutCallback=function(){try{callback($public);}catch(e){}};$private.isValidTimeout=function(){if(!$private.typeValidator.isFunction(callback)){return false;}if(!$private.typeValidator.isNumber(delay)){return false;}if(delay===0){return false;}return true;};$public.pause=function(){$private.clearTimeout();$private.remaining=$private.calculateTimeRemaining();};$private.clearTimeout=function(){if($private.timeout){window.clearTimeout($private.timeout);$private.timeout=undefined;$private.isCalling=false;}};$private.calculateTimeRemaining=function(){var timeSpent=Date.now()-$private.startTime;return Math.floor($private.remaining-timeSpent);};$public.updateDelay=function(newDelay){$private.clearTimeout();var remaining=newDelay-$public.calculateTimeSpent();if(remaining>0){$private.remaining=delay=remaining;$public.play();}else{$public.stop();$private.timeoutCallback();}};$public.calculateTimeSpent=function(){return delay-$private.calculateTimeRemaining();};$public.stop=function(){$private.clearTimeout();$private.remaining=delay;};}function Visibility(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$private.__constructor=(function(){$private.hasListener=false;$public.elements={};$private.lastPos=window.scrollY;})();$public.addElement=function(id,requestDelay,callbackVisible,callbackInvisible){var element=document.getElementById(id);if(!element){return;}if(!$private.typeValidator.isFunction(callbackVisible)){return;}var visibilityItem={"element":element,"callbackVisible":callbackVisible,"focusInit":$public.hasFocus(),"isVisible":false};$public.elements[id]=visibilityItem;if($private.typeValidator.isFunction(callbackInvisible)){visibilityItem.callbackInvisible=callbackInvisible;}if($private.typeValidator.isNumericString(requestDelay)){visibilityItem.requestDelay=Number(requestDelay);}visibilityItem.visibilityInit=$public.isElementOnScreen(visibilityItem);$private.startListening();$public.checkVisibility();};$public.hasFocus=function(){return window.UOLPD.dataLayer.hasFocus==="true";};$public.isElementOnScreen=function(item){if(!$private.typeValidator.isObject(item)){return false;}if(!$private.typeValidator.isDefined(item.element)){return false;}if(!$public.hasFocus()){return false;}if(!$private.isElementVisible(item.element,item.requestDelay)){return false;}return true;};$private.isElementVisible=function(element,requestDelay){var position=element.getBoundingClientRect();var percentage=$private.getVisibilityPercentage(element);if(!$public.isElementVisibleOnDom(element)){return false;}if($private.isAboveVisibleArea(position,percentage,requestDelay)){return false;}if($private.isBelowVisibleArea(position,percentage,requestDelay)){return false;}return true;};$public.isElementVisibleOnDom=function(element){if(element){return element.offsetParent!==null;}else{return false;}};$private.getVisibilityPercentage=function(element){if($private.calculateElementArea(element)>242500){return 100/30;}return 100/50;};$private.calculateElementArea=function(element){var firstChild=element.firstChild;if(!$private.typeValidator.isDefined(firstChild)){return 0;}return firstChild.offsetWidth*firstChild.offsetHeight;};$private.isAboveVisibleArea=function(position,percentage,requestDelay){var distance=(position.height/percentage)*-1;return position.bottom<distance;};$private.isBelowVisibleArea=function(position,percentage,requestDelay){var distance=(position.height/percentage)+window.innerHeight;if($private.typeValidator.isInt(requestDelay)){distance=$private.calculateDistance(requestDelay);}return position.bottom>distance;};$private.calculateDistance=function(requestDelay){window.__averageSlotsLoadTime=window.__averageSlotsLoadTime||0;var distance=window.innerHeight+$private.getDelta()+requestDelay+window.__averageSlotsLoadTime;distance=distance/2;return distance;};$private.getDelta=function(){var delta=window.scrollY-$private.lastPos;$private.lastPos=window.scrollY;return delta;};$private.startListening=function(){if(!$private.hasListener){$public.focusInterval=window.setInterval($public.checkVisibility,50);$private.hasListener=true;}};$public.checkVisibility=function(){for(var id in $public.elements){$private.handleCallback($public.elements[id]);}};$private.handleCallback=function(item){var isVisible=$public.isElementOnScreen(item);if(isVisible){item.callbackVisible();}else{if(item.callbackInvisible){item.callbackInvisible();}}item.isVisible=isVisible;};}function ConfigConsolidator(namTag,namespace,timestampInit){var $private={};var $public=this;$private.namTag=namTag;$private.namespace=namespace;$private.timestampInit=timestampInit;$private.typeValidator=new TypeValidator();$public.logger=new Logs();$public.trackManager=new TrackManager();$public.logger.setPrefix("UOLPD.TagManager.DfpAsync");$public.trackManager.setModuleName("dfp-async");$public.consolidate=function(config,uoladsConfig){if(config.forcePath[0]==="forcePath"&&!$private.typeValidator.isString(config.dfppath)){$public.logger.warn('O item de configuração "Forçar Path" só pode ser ativado caso o item "Path do DFP" esteja preenchido',$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_dfppath","O objeto de configuração está inválido");return;}var finalConfig=$private.addUoladsItems(config,uoladsConfig);finalConfig.dfppath=$private.processAdUnit(finalConfig.forcePath[0],finalConfig.dfppath,uoladsConfig.adUnit);if(!finalConfig.dfppath){$public.logger.warn("Não foi encontrado o AdUnit da tag",$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_dfppath","O AdUnit está inválido");return;}finalConfig.customTargetings=$private.mergeCustomTargetings(finalConfig.customTargetings,uoladsConfig.customTargetings);var keyword=$private.getKeywordValue(finalConfig.keyword);if($private.typeValidator.isString(keyword)){finalConfig.keyword=keyword;}return finalConfig;};$private.calculateTimeSpent=function(){return(new Date()).getTime()-$private.timestampInit;};$private.addUoladsItems=function(config,uoladsConfig){var finalConfig,key;finalConfig={};for(key in config){finalConfig[key]=config[key];}for(key in uoladsConfig){if(key==="id"||key==="customTargetings"||key==="adUnit"){continue;}if($private.typeValidator.isDefined(finalConfig[key])){continue;}if(key==="label"){key="deslabel";uoladsConfig.deslabel=uoladsConfig.label;}if($private.typeValidator.isDefined(uoladsConfig[key])){finalConfig[key]=uoladsConfig[key];}}finalConfig.bannerId=uoladsConfig.id;return finalConfig;};$private.processAdUnit=function(forcePath,configPath,uoladsAdUnit){if(forcePath==="forcePath"){return configPath;}var adUnit=$private.convertPathToAdUnit(configPath);adUnit=$private.overrideAdUnit(uoladsAdUnit,adUnit);if($private.isValidUvar()){adUnit=$private.overrideAdUnit(window.universal_variable.dfp.custom_params,adUnit);}if(!$private.typeValidator.isString(adUnit.network)){$public.logger.warn('O "Path do DFP" configurado para esta página está vazio',$private.namTag,$private.namespace,$private.calculateTimeSpent());return;}if(!$private.typeValidator.isString(adUnit.site)){return"/"+adUnit.network;}if(!$private.typeValidator.isString(adUnit.chan)){return"/"+adUnit.network+"/"+adUnit.site;}if(!$private.typeValidator.isString(adUnit.subchan)){return"/"+adUnit.network+"/"+adUnit.site+"/"+adUnit.chan;}return"/"+adUnit.network+"/"+adUnit.site+"/"+adUnit.chan+"/"+adUnit.subchan;};$private.convertPathToAdUnit=function(path){if(!$private.typeValidator.isString(path)){return{};}var hierarchy=["network","site","chan","subchan"];var length=hierarchy.length;var adUnit={};path=path.split("/");if(!path){return{};}if(!$private.typeValidator.isString(path[0])){path.shift();}if(path.length>length){path[3]=path[3]+"/"+path.splice(length).join("/");}for(var i=0;i<length;i++){if($private.typeValidator.isString(path[i])){adUnit[hierarchy[i]]=path[i];}}return adUnit;};$private.overrideAdUnit=function(attrAdUnit,finalAdUnit){for(var key in attrAdUnit){if($private.typeValidator.isString(finalAdUnit[key])){continue;}if(!$private.typeValidator.isString(attrAdUnit[key])){continue;}finalAdUnit[key]=attrAdUnit[key];}return finalAdUnit;};$private.isValidUvar=function(){if(!$private.typeValidator.isObject(window.universal_variable)){return false;}if(!$private.typeValidator.isObject(window.universal_variable.dfp)){return false;}if(!$private.typeValidator.isObject(window.universal_variable.dfp.custom_params)){return false;}return true;};$private.mergeCustomTargetings=function(configCustomTargetings,adCustomTargetings){var finalCustomTargetings={};if($private.typeValidator.isString(configCustomTargetings)){try{configCustomTargetings=JSON.parse(configCustomTargetings);}catch(e){}}$private.defineCustomTargetings(configCustomTargetings,finalCustomTargetings);$private.defineCustomTargetings(adCustomTargetings,finalCustomTargetings);return finalCustomTargetings;};$private.defineCustomTargetings=function(customTargetings,finalCustomTargetings){if(!$private.typeValidator.isObject(customTargetings)){return;}for(var key in customTargetings){if(finalCustomTargetings[key]){continue;}if($private.typeValidator.isString(customTargetings[key])){finalCustomTargetings[key]=customTargetings[key];}}};$private.getKeywordValue=function(keyword){if($private.typeValidator.isString(keyword)){return(keyword);}if(!$private.isValidUvarKeyword()){return;}return window.universal_variable.dfp.custom_params.keyword;};$private.isValidUvarKeyword=function(){if(!$private.isValidUvar()){return false;}if(!$private.typeValidator.isString(window.universal_variable.dfp.custom_params.keyword)){return false;}return true;};}function Slot(namTag,namespace,timestampInit){var $private={};var $public=this;$private.namTag=namTag;$private.namespace=namespace;$private.timestampInit=timestampInit;$private.typeValidator=new TypeValidator();$private.contentValidator=new ContentValidator();$public.logger=new Logs();$public.trackManager=new TrackManager();$public.logger.setPrefix("UOLPD.TagManager.DfpAsync");$public.trackManager.setModuleName("dfp-async");$public.build=function(config){if(!document.getElementById(config.bannerId)){$public.logger.error('O slot não foi criado pois o elemento de id "'+config.bannerId+'" não existe no DOM',$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("missing_dom_element","fluxo_interrompido");return;}if(config.fluid[0]==="true"){$private.slot=window.googletag.defineSlot(config.dfppath,"fluid",config.bannerId);}if(!$private.slot&&config.outOfPage[0]==="outOfPage"){$private.slot=window.googletag.defineOutOfPageSlot(config.dfppath,config.bannerId);}if(!$private.slot&&(config.bannerWidth&&config.bannerHeight)){$private.slot=window.googletag.defineSlot(config.dfppath,[parseInt(config.bannerWidth),parseInt(config.bannerHeight)],config.bannerId);}if(!$private.slot){$public.trackManager.trackError("invalid_slot","fluxo_interrompido");return;}if(config.isCompanion==="true"){$private.slot.addService(window.googletag.companionAds());}$private.slot.addService(window.googletag.pubads());if(config.sizeMapping){$private.defineSizeMapping(config.sizeMapping);}$private.setTargetings(config);return $private.slot;};$private.calculateTimeSpent=function(){return(new Date()).getTime()-$private.timestampInit;};$private.defineSizeMapping=function(sizeMapping){var mapping=$private.buildMapping(sizeMapping);if(mapping){$private.slot.defineSizeMapping(mapping);}};$private.buildMapping=function(sizeMappings){var matchedMappings=sizeMappings.match(/(\[\d+\,\s?\d+\])+(\,\s?)(\[\d+\,\s?\d+\]|\[(\[\d+\,\s*\d+\](\,\s*)*)+\])(\;?\s?)?/g);if(!matchedMappings){$public.logger.warn('Não foi possível gerar o sizeMapping no DFP, a configuração "'+sizeMappings+'" é inválida.',$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_size_mapping","fluxo_interrompido");return;}var mapping=window.googletag.sizeMapping();for(var i=0,length=matchedMappings.length;i<length;i++){var sizeMapping=$private.convertSizeMappingItem(matchedMappings[i]);if(sizeMapping){mapping=mapping.addSize(sizeMapping.viewportSize,sizeMapping.slotSize);}}return mapping.build();};$private.convertSizeMappingItem=function(sizeMapping){try{var matches=sizeMapping.match(/(\[\d+\,\s?\d+\]|\[(\[\d+\,\s*\d+\](\,\s*)*)+\])(\,(\s)?(\[\d+\,\s?\d+\]|\[(\[\d+\,\s*\d+\](\,\s*)*)+\]))+/);return{"viewportSize":JSON.parse(matches[1]),"slotSize":JSON.parse(matches[6])};}catch(e){$public.logger.warn('Não foi possível gerar o sizeMapping no DFP, a configuração "'+sizeMapping+'" é inválida.',$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_size_mapping","fluxo_interrompido");return;}};$private.setTargetings=function(config){if($private.typeValidator.isString(config.campaignuol)||$private.typeValidator.isNumber(config.campaignuol)){$private.slot.setTargeting("campaignuol",config.campaignuol);}if($private.typeValidator.isString(config.expble)){$private.slot.setTargeting("expble",config.expble);}if($private.typeValidator.isString(config.group)){$private.slot.setTargeting("group",config.group);}if($private.typeValidator.isString(config.keyword)){$private.slot.setTargeting("keyword",config.keyword);}if($private.typeValidator.isString(config.pos)||$private.typeValidator.isNumber(config.pos)){$private.slot.setTargeting("pos",config.pos);}if($private.typeValidator.isString(config.deslabel)){$private.slot.setTargeting("label",config.deslabel);}if($private.typeValidator.isNumericString(config.nativeType)||$private.typeValidator.isNumber(config.nativeType)){$private.slot.setTargeting("native",config.nativeType);}if(config.bannerWidth&&config.bannerHeight){var size=config.bannerWidth+"x"+config.bannerHeight;$private.addAudienceScience(size);}if($private.typeValidator.isObject(config.customTargetings)){for(var key in config.customTargetings){$private.slot.setTargeting(key,config.customTargetings[key]);}}if($private.typeValidator.isObject(window.UOLPD.adTargetings)){$public.setPrebidTargetings(config.bannerId,config.isIncremental,$private.slot);}};$public.setPrebidTargetings=function(bannerId,isIncremental,slot){var prebidAdTargetings=$private.findPrebidTargetings(bannerId,isIncremental);if($private.typeValidator.isObject(prebidAdTargetings)&&slot){for(var key in prebidAdTargetings){slot.setTargeting(key,prebidAdTargetings[key]);}}};$private.findPrebidTargetings=function(bannerId,isIncremental){var incremental=$private.isIncremental(isIncremental),adserverTargeting;if(incremental){for(var ad in window.UOLPD.adTargetings){if(bannerId.indexOf(ad)===0){adserverTargeting=window.UOLPD.adTargetings[ad];}}}if(window.UOLPD.adTargetings[bannerId]){adserverTargeting=window.UOLPD.adTargetings[bannerId];}return adserverTargeting;};$private.isIncremental=function(isIncremental){if(isIncremental==="true"||isIncremental==="updateCorrelator"){return true;}return false;};$private.addAudienceScience=function(size){var dfpPlacements=window.adPlacements;var audienceSciencePlacements;if($private.contentValidator.isFilledObject(dfpPlacements)){audienceSciencePlacements=$private.formatPlacements(dfpPlacements,size);}if($private.typeValidator.isString(audienceSciencePlacements)){$private.slot.setTargeting("gwd",audienceSciencePlacements);}};$private.formatPlacements=function(dfpPlacements,size){var placements=[];for(var placement in dfpPlacements){if(dfpPlacements[placement]===size){placements.push(placement);}}placements=placements.toString();if(!$private.typeValidator.isString(placements)){return;}return placements;};$public.destroySlots=function(slot){if($private.typeValidator.isArray(slot)){return window.googletag.destroySlots(slot);}return false;};}function Rotative(namTag,namespace,timestampInit){var $private={};var $public=this;$private.namTag=namTag;$private.namespace=namespace;$private.timestampInit=timestampInit;$private.typeValidator=new TypeValidator();$public.logger=new Logs();$public.trackManager=new TrackManager();$public.logger.setPrefix("UOLPD.TagManager.DfpAsync");$public.trackManager.setModuleName("dfp-async");$public.createDivs=function(adsLength,bannerId){if(!$private.typeValidator.isNumber(adsLength)){$public.logger.warn("A quantidade de anúncios rotativos não foi informada corretamente",$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_rotative_length","fluxo_interrompido");return;}if(!$private.typeValidator.isString(bannerId)){$public.logger.warn("O atributo bannerId do config não foi repassado para os anúncios rotativos",$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_rotative_bannerid","fluxo_interrompido");return;}$private.divs=[];var content=document.getElementById(bannerId);content.style.overflow="hidden";for(var i=1;i<=adsLength;i++){var div=$private.createDiv(bannerId,i);content.appendChild(div);$private.divs.push(div);}return $private.divs;};$private.calculateTimeSpent=function(){return(new Date()).getTime()-$private.timestampInit;};$private.createDiv=function(bannerId,index){var div=document.createElement("div");div.id=bannerId+"-rotative-"+index;if(index>1){div.style.display="none";}else{div.style.display="block";}return div;};$public.rotate=function(){if(!$private.typeValidator.isArray($private.divs)){return false;}setInterval(function(){var index=$private.getVisibleDivIndex();for(var i=0;i<$private.divs.length;i++){$private.divs[i].style.display="none";}index++;if(index>$private.divs.length-1){index=0;}$private.divs[index].style.display="block";},3000);};$private.getVisibleDivIndex=function(){for(var i=0;i<$private.divs.length;i++){if($private.divs[i].style.display!="none"){return i;}}};}function DfpAsync(){var $private={};var $public=this;$private.scriptUtils=new ScriptUtils();$private.schema=new Schema(DfpSchema);$private.typeValidator=new TypeValidator();$private.contentValidator=new ContentValidator();$private.visibility=visibility;$private.cookieUtils=new CookieUtils();$public.trackManager=new TrackManager();$public.logger=new Logs();$private.__constructor=function(){$public.logger.setPrefix("UOLPD.TagManager.DfpAsync");$public.trackManager.setModuleName("dfp-async");$private.GPT_URL="//www.googletagservices.com/tag/js/gpt.js";};$public.init=function(config,namTag,namespace){$private.configureLogger(namTag,namespace);$private.createUolads();if(!$private.schema.isValid(config)){$public.logger.error("A configuração fornecida pelo Tag Manager está inválida, as seguintes propriedades de configuração: "+$private.schema.invalidProperties.join(", ")+" não existem ou são inválidas",$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_config","O objeto de configuração está inválido");return;}if(!$private.scriptUtils.hasTagScript($private.GPT_URL)){$private.scriptUtils.appendTag($private.scriptUtils.createScript($private.GPT_URL));}if(!$private.defineGlobalDFPTags(config)){return;}window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];window.googletag.cmd.push($private.checkAsyncRendering);window.__configuredDFPTags[config.bannerId].timeStampInit=$private.timeStampInit;window.__configuredDFPTags[config.bannerId].executionTime=$private.calculateTimeSpent();window.__dfpAsyncRenderingCallbacks=window.__dfpAsyncRenderingCallbacks||{};$private.checkEnqueue(config.isIncremental,config.bannerId);};$private.configureLogger=function(namTag,namespace){$private.namTag=namTag;$private.namespace=namespace;$private.timeStampInit=(new Date()).getTime();$public.trackManager.trackSuccess("Execucoes Iniciadas");};$private.calculateTimeSpent=function(timeStampInit){if(!$private.typeValidator.isDefined(timeStampInit)){return(new Date()).getTime()-$private.timeStampInit;}return(new Date()).getTime()-timeStampInit;};$private.createUolads=function(){window.uolads=window.uolads||[];window.uolads.push=$private.push;};$private.defineGlobalDFPTags=function(config){if(!$private.typeValidator.isObject(window.__configuredDFPTags)){window.__configuredDFPTags={};}if(window.__configuredDFPTags[config.bannerId]){$public.logger.warn('Uma tag com o id "'+config.bannerId+'" já foi executada nesta página, verifique suas configurações.',$private.namTag,$private.namespace,$private.calculateTimeSpent());return;}window.__configuredDFPTags[config.bannerId]={};window.__configuredDFPTags[config.bannerId].namTag=$private.namTag;window.__configuredDFPTags[config.bannerId].timeStampInit=$private.timeStampInit;window.__configuredDFPTags[config.bannerId].config=config;window.__configuredDFPTags[config.bannerId].ads={};return window.__configuredDFPTags;};$private.checkAsyncRendering=function(){var isAsyncRenderEnabled=window.googletag.pubads().enableAsyncRendering();if(!isAsyncRenderEnabled){$public.logger.error('A página está configurada para renderizar de forma síncrona, favor remover a chamada "window.googletag.pubads().enableSyncServices()"',$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("mixed_sync_rendering","fluxo_interrompido");return;}$private.setPubadsTargetings();};$private.setPubadsTargetings=function(){var tagPages=$private.getTagPages();if(tagPages){googletag.pubads().setTargeting("tags",tagPages);$public.logger.debug('Definindo o targeting "tags" no escopo da página.');}if(!$private.hasDataLayer()){$public.logger.warn('Os targetings da "dataLayer" do UOLPD não foram definidos pois a "dataLayer" não existe ou é um objeto inválido.',$private.namTag,$private.namespace,$private.calculateTimeSpent());return;}for(var target in UOLPD.dataLayer){var targetValue=UOLPD.dataLayer[target];if(!$private.typeValidator.isString(targetValue)){$public.logger.debug('O targeting "'+target+'" não foi definido por ser inválido.');continue;}googletag.pubads().setTargeting(target,targetValue);$public.logger.debug('Definindo o targeting "'+target+'" no escopo da página.');}};$private.getTagPages=function(){var uvar=window.universal_variable;if(!$private.isValidTagPages(uvar)){$public.logger.debug('Os targetings da "page.tags" da UVAR não foram definidos pois a "page.tags" não existe ou é um array inválido.');return;}var pageTags=[];for(var i=0,length=uvar.page.tags.length;i<length;i++){var tag=uvar.page.tags[i];if($private.typeValidator.isString(tag)||$private.typeValidator.isNumber(tag)){pageTags.push(tag);}}if(pageTags.length===0){$public.logger.debug('Os targetings da "page.tags" da UVAR não foram definidos pois a "page.tags" não existe ou é um array inválido.');return;}return pageTags;};$private.isValidTagPages=function(uvar){if(!$private.typeValidator.isObject(uvar)){return false;}if(!$private.typeValidator.isObject(uvar.page)){return false;}if(!$private.typeValidator.isArray(uvar.page.tags)){return false;}return true;};$private.hasDataLayer=function(){if(!$private.typeValidator.isObject(window.UOLPD)){return false;}if(!$private.typeValidator.isObject(window.UOLPD.dataLayer)){return false;}return true;};$private.checkEnqueue=function(incremental,id){for(var i=0;i<uolads.length;i++){var data=uolads[i];if(!data){break;}if($private.checkIncremental(incremental,data,id)){$private.push(data);i--;}else{if(data.id===id){$private.push(data);break;}}if(i<=0&&uolads.length===0){break;}}};$private.checkIncremental=function(incremental,data,id){if(!$private.isIncremental(incremental)){return false;}if(data.id.indexOf(id)<0){return false;}return true;};$private.isIncremental=function(isIncremental){if(isIncremental==="true"){return true;}if(isIncremental==="updateCorrelator"){return true;}return false;};$private.push=function(ad){var timeStampInit=(new Date()).getTime();if(!$private.isValidAd(ad)){$public.logger.warn('O parâmetro passado para o "push" é inválido.',"Tag inválida",$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_uolads_push","fluxo_interrompido");return;}$private.removeElementEnqueue(ad.id);if($private.checkAdBlocker(ad.id)){return;}var configuredTag=$private.getConfiguredTag(ad);if(!configuredTag){Array.prototype.push.call(window.uolads,ad);return;}var tagAd=$private.getAdById(ad.id);if(tagAd){tagAd.timeStampInit=timeStampInit;$public.refreshSlot(ad.id);return;}$private.configConsolidator=new ConfigConsolidator(configuredTag.namTag,$private.namespace,timeStampInit);var config=$private.configConsolidator.consolidate(configuredTag.config,ad);if(!config){$public.logger.error("O objeto de configuração do id: "+ad.id+" não está válido.",configuredTag.namTag,$private.namespace,$private.calculateTimeSpent(configuredTag.timeStampInit));return;}if(!$private.isBannerEnable(config,configuredTag.namTag)){return;}if(parseInt(config.rotative)>1){$private.buildRotativeAds(configuredTag,config,timeStampInit);}else{$private.buildAd(configuredTag,config,timeStampInit);}};$private.isValidAd=function(ad){if(!$private.typeValidator.isObject(ad)){return false;}if(!$private.typeValidator.isString(ad.id)){return false;}return true;};$private.removeElementEnqueue=function(id){var queue=window.uolads;if($private.typeValidator.isArray(queue)&&queue.length>0){window.uolads=$private.removeElementFromEnqueue(queue,id);}};$private.removeElementFromEnqueue=function(elements,id){for(var i=0;i<elements.length;i++){var element=elements[i];if(!element.id){continue;}if(element.id===id){elements.splice(i,1);i--;}}return elements;};$private.checkAdBlocker=function(id){var block;try{block=window.localStorage.getItem("adblocker");}catch(e){}if(block==="1"){$private.metricsAdblocker(id);return true;}return false;};$private.metricsAdblocker=function(id){var metrics={"groups":{"adblocker":"1"},"measures":{"Execution":"1"}};var size;var configuredTag=window.__configuredDFPTags;for(var key in configuredTag){if(id.match(key)){size=$private.getSizeById(configuredTag[key].config,id);break;}}if(size){metrics.groups.size=size;}$public.trackManager.trackCustomObj(metrics,100);};$private.getSizeById=function(tag,id){var size;if(tag.fluid[0]==="true"){size="0x0";}if(tag.bannerWidth&&tag.bannerHeight){size=tag.bannerWidth+"x"+tag.bannerHeight;}return size;};$private.getConfiguredTag=function(ad){for(var tag in window.__configuredDFPTags){var isIncremental=$private.isIncremental(window.__configuredDFPTags[tag].config.isIncremental);if(ad.id===tag&&!isIncremental){return window.__configuredDFPTags[tag];}if(ad.id.indexOf(tag)===0&&isIncremental){return window.__configuredDFPTags[tag];}}return;};$private.getAdById=function(bannerId){var configuredDfpTags=window.__configuredDFPTags;if(!$private.typeValidator.isObject(configuredDfpTags)){return;}for(var key in configuredDfpTags){var ads=configuredDfpTags[key].ads;if(!$private.typeValidator.isObject(ads)){return;}for(var ad in ads){if(ad==bannerId){return ads[bannerId];}}}return;};$public.refreshSlot=function(id){var ad=$private.getAdById(id);if(!ad||!ad.slot){$public.logger.debug('O slot "'+id+'" não foi configurado.');return;}if(!$private.visibility.isElementVisibleOnDom(document.getElementById(id))){var configuredTag=$private.getConfiguredTag({"id":id});$public.logger.error("Não foi possível efetuar o recarregamento pois elemento com id: "+id+" foi adicionado à fila e não está visível no DOM, favor validar o seu CSS.",configuredTag.namTag,$private.namespace,$private.calculateTimeSpent(configuredTag.timeStampInit));$public.trackManager.trackError("refresh_element_hidden","fluxo_interrompido");return;}ad.timeStampInit=(new Date()).getTime();if($private.typeValidator.isNumericString(ad.config.timeToRefresh)){$private.setRefreshAtivo(ad.slot,ad.config.keyword);}if($private.typeValidator.isObject(window.UOLPD.adTargetings)){(new Slot()).setPrebidTargetings(ad.config.bannerId,ad.config.isIncremental,ad.slot);}$public.logger.log('Recarregando o anúncio de id "'+ad.config.bannerId+'"',ad.namTag,$private.namespace,$private.calculateTimeSpent(ad.timeStampInit));googletag.pubads().refresh([ad.slot]);};$private.setRefreshAtivo=function(slot,keyword){if($private.typeValidator.isString(keyword)){slot.setTargeting("keyword",keyword+", "+"refreshativo");}else{slot.setTargeting("keyword","refreshativo");}};$private.isBannerEnable=function(config,namTag){if(config.hide==="True"){$private.hideSlot(config.bannerId);$public.logger.warn('O anúncio com o id: "'+config.bannerId+'" está configurado para não ser exibido.',namTag,$private.namespace,$private.calculateTimeSpent(config.timeStampInit));return false;}if(config.bannerWidth!="1"||config.bannerHeight!="1"||config.frequencyControl[0]!="true"){return true;}var cookieName=$private.buildCookieName(config.dfppath,config.bannerId);if($private.cookieUtils.getItem(cookieName)){$public.logger.debug('O anúncio com o id "'+config.bannerId+'" não será exibido pois é um DHTML e está com o "frequencyControl" habilitado.');return false;}$private.cookieUtils.setItem(cookieName,"1; expires=0; path=/");$public.logger.debug('Configurando o cookie "'+cookieName+'" do anúncio "'+config.bannerId+'" com o valor 1.');return true;};$private.hideSlot=function(id){var container=document.getElementById(id);if(!container){return;}container.style.display="none";if(!container.parentNode){return;}if(container.parentNode.className==="publicidade"||container.parentNode.className==="pub"){container.parentNode.style.display="none";}};$private.buildCookieName=function(dfppath,bannerId){var siteChanSubchan=dfppath.split("/");if(!$private.typeValidator.isString(siteChanSubchan[2])){$public.logger.debug('O cookie de sessão do DHTML "'+bannerId+'" não foi criado pois o path não possui o "site".');return;}var cookieName=siteChanSubchan[2];if(siteChanSubchan[3]){cookieName+="_"+siteChanSubchan[3];}if(siteChanSubchan[4]){cookieName+="_"+siteChanSubchan[4];}return cookieName;};$private.buildRotativeAds=function(configuredTag,config,timeStampInit){var rotative=new Rotative(configuredTag,$private.namespace,timeStampInit);var divs=rotative.createDivs(parseInt(config.rotative),config.bannerId);if(!divs){$public.logger.error("As divs para os anúncios rotativos não foram criadas",configuredTag.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("missing_element","fluxo_interrompido");return;}for(var i=0;i<divs.length;i++){var bannerId=divs[i].getAttribute("id");$private.buildAd(configuredTag,$private.cloneObject(config),timeStampInit,bannerId);}rotative.rotate();};$private.cloneObject=function(original){return JSON.parse(JSON.stringify(original));};$private.buildAd=function(configuredTag,config,timeStampInit,overrideBannerId){var bannerId=config.bannerId;if(overrideBannerId){bannerId=overrideBannerId;}if($private.shouldUpdateCorrelator(config.isIncremental,configuredTag.ads)){window.googletag.cmd.push(function(){window.googletag.pubads().updateCorrelator();});}var ad={};ad.namTag=configuredTag.namTag;ad.timeStampInit=timeStampInit;ad.focusInit=$private.visibility.hasFocus();ad.config=config;ad.config.bannerId=bannerId;configuredTag.ads[bannerId]=ad;var element={"element":document.getElementById(ad.config.bannerId)};ad.visibilityInit=$private.visibility.isElementOnScreen(element);if($private.shouldSetLocation(configuredTag,config.geolocation)){$private.setLocation(configuredTag);}if(!config.requestDelay){$private.display(configuredTag,configuredTag.ads[bannerId]);return;}$private.visibility.addElement(bannerId,config.requestDelay,function(){delete $private.visibility.elements[bannerId];$private.display(configuredTag,configuredTag.ads[bannerId]);});};$private.shouldUpdateCorrelator=function(isIncremental,ads){if(isIncremental!=="updateCorrelator"){return false;}if($private.contentValidator.isFilledObject(ads)){return true;}return false;};$private.shouldSetLocation=function(configuredTag,geolocation){configuredTag.hasGeolocation=false;if(!$private.typeValidator.isString(geolocation)){return false;}if($public.getProtocol()!=="https:"){return false;}if(geolocation.toLowerCase()!=="true"){return false;}if($private.isGeolocationAlreadySetted()){configuredTag.hasGeolocation=true;return false;}return true;};$public.getProtocol=function(){return window.location.protocol;};$private.isGeolocationAlreadySetted=function(){var configuredDfpTags=window.__configuredDFPTags;for(var tag in configuredDfpTags){if(tag.hasGeolocation===true){return true;}}return false;};$private.setLocation=function(configuredTag){var locationSuccessCallback=function(position){var coordinates=position.coords;if($private.isValidCoordinates(coordinates)){configuredTag.hasGeolocation=true;googletag.cmd.push(function(){googletag.pubads().setLocation(coordinates.latitude,coordinates.longitude);});}};var locationFailureCallback=function(err){$public.logger.debug("O usuário não permitiu o uso da localização.");};try{}catch(e){}};$private.isValidCoordinates=function(coordinates){if(typeof coordinates!=="object"){return false;}if(!$private.typeValidator.isNumber(coordinates.latitude)){return false;}if(!$private.typeValidator.isNumber(coordinates.longitude)){return false;}return true;};$private.display=function(configuredTag,ad){if(!ad.slot){$private.runWhenElementIsPresent(function(){window.googletag.cmd.push($private.configuredDfpSlots(configuredTag,ad));},ad.config.bannerId);}};$private.runWhenElementIsPresent=function(callback,id){if(document.getElementById(id)){callback();return;}var count=(30*20);var intervalId=window.setInterval(function(){if(document.getElementById(id)||count<=0){clearInterval(intervalId);callback();}count--;},50);};$private.configuredDfpSlots=function(configuredTag,ad){var slot=new Slot(configuredTag.namTag,$private.namespace,ad.timeStampInit);ad.executionTime=$private.calculateTimeSpent(ad.timeStampInit);return function(){if(ad.slot){return;}var timeStamp=(new Date()).getTime();slot=slot.build(ad.config);if(!slot){ad.executionTime=ad.executionTime+$private.calculateTimeSpent(timeStamp);$public.logger.error('Não foi possível configurar o slot com o id "'+ad.config.bannerId+'" no DFP.',configuredTag.namTag,$private.namespace,ad.executionTime+configuredTag.executionTime);return;}if(!window.__servicesRequest){$private.servicesRequest();}$private.addSlotInConfiguredTags(configuredTag.config.bannerId,ad.config.bannerId,slot);$public.trackManager.trackSuccess("Execucoes Finalizadas");$public.addPubadsEvent("slotRenderEnded",$private.renderingCallback);ad.executionTime=ad.executionTime+$private.calculateTimeSpent(timeStamp);if(!$private.visibility.isElementVisibleOnDom(document.getElementById(ad.config.bannerId))&&!ad.config.rotative){$public.logger.warn("O elemento com id: "+ad.config.bannerId+" esta sendo usado para entregar o criativo mas a mesmo não está visível no DOM, favor verificar o seu CSS.",configuredTag.namTag,$private.namespace,$private.calculateTimeSpent(configuredTag.timeStampInit));$public.trackManager.trackError("element_hidden","fluxo_interrompido");}else{$public.logger.log("Exibindo o anúncio de id "+ad.config.bannerId,configuredTag.namTag,$private.namespace,ad.executionTime+configuredTag.executionTime);}$private.requestAd(ad);};};$private.calculateExecutionTime=function(tagExecutionTime,adExecutionTime){return tagExecutionTime+$private.calculateTimeSpent(adExecutionTime);};$private.servicesRequest=function(){if(window.googletag.pubadsReady===true){window.dontRefresh=true;return;}window.__servicesRequest=true;window.googletag.pubads().enableSingleRequest();window.googletag.pubads().disableInitialLoad();window.googletag.enableServices();};$private.addSlotInConfiguredTags=function(tagId,slotId,slot){window.__configuredDFPTags[tagId].ads=window.__configuredDFPTags[tagId].ads||{};window.__configuredDFPTags[tagId].ads[slotId]=window.__configuredDFPTags[tagId].ads[slotId]||{};window.__configuredDFPTags[tagId].ads[slotId].slot=slot;};$public.addPubadsEvent=function(eventName,callback){if(!$private.typeValidator.isString(eventName)){$public.logger.debug("Não foi possível criar um evento customizado pois o nome não é uma string válida.");return;}if(!$private.typeValidator.isFunction(callback)){$public.logger.debug("Não foi possível criar um evento customizado pois o callback não é uma função válida.");return;}window.__dfpEvent=window.__dfpEvent||[];if(window.__dfpEvent[eventName]){return;}window.__dfpEvent[eventName]=true;googletag.pubads().addEventListener(eventName,function(eventObject){var ad=$private.getAdBySlot(eventObject.slot);if(ad&&ad.config){callback(eventObject,ad.config.bannerId);}});};$private.getAdBySlot=function(slot){var __configuredDFPTags=window.__configuredDFPTags;for(var key in __configuredDFPTags){var configuredTag=__configuredDFPTags[key];for(var id in configuredTag.ads){if(configuredTag.ads[id].slot===slot){return configuredTag.ads[id];}}}return;};$public.addRenderingCallback=function(bannerId,callback){window.__dfpAsyncRenderingCallbacks[bannerId]=callback;};$private.renderingCallback=function(eventObject,bannerId){if(!eventObject){return;}var ad=$private.getAdBySlot(eventObject.slot);if($private.typeValidator.isArray(eventObject.size)){ad.size=$private.addSize(eventObject.size);}ad.loadTime=$private.calculateTimeSpent(ad.timeStampInit);ad.timeStampEnd=(new Date()).getTime();$private.generateMetrics(ad);$private.calculateAverageSlotsLoadTime(ad.loadTime);var timeToRefresh=parseInt(ad.config.timeToRefresh);if(timeToRefresh>0){$private.enableAdRefresh(ad,timeToRefresh);}var callback=window.__dfpAsyncRenderingCallbacks[bannerId];if($private.typeValidator.isFunction(callback)){callback(eventObject,bannerId);}};$private.addSize=function(eventSize){var size={};if($private.typeValidator.isNumber(eventSize[0])){size.width=eventSize[0];}if($private.typeValidator.isNumber(eventSize[1])){size.height=eventSize[1];}return size;};$private.generateMetrics=function(ad){ad.metrics=ad.metrics||{};ad.metrics.groups={"id":ad.config.bannerId,"path":ad.config.dfppath,"referer":encodeURIComponent($private.getAdReferrerUrl().split("?")[0]),"size":ad.size.width+"x"+ad.size.height};$private.addGroupsFocus(ad);$private.addGroupsGeolocation(ad);$private.addMeasuresTime(ad);$private.addTime(ad);$public.trackManager.trackCustomObj(ad.metrics);};$private.addTime=function(ad){if($private.isOutsideTime(ad.metrics.measures.LoadTime,30000)||$private.isOutsideTime(ad.metrics.measures.executionTime,1000)){ad.metrics.measures.OutsideTime=1;ad.metrics.groups.groupType=2;}else{ad.metrics.measures.Execution=1;ad.metrics.groups.groupType=1;}};$private.isOutsideTime=function(time,max){if(time<0){return true;}if(time>max){return true;}return false;};$private.getAdReferrerUrl=function(){if(window.top!==self){return document.referrer;}return window.location.href;};$private.addGroupsFocus=function(ad){ad.metrics.groups.focus=$private.visibility.hasFocus().toString();ad.metrics.groups.focusInit=ad.focusInit.toString();var element={"element":document.getElementById(ad.config.bannerId)};ad.metrics.groups.visibilityInit=ad.visibilityInit.toString();ad.metrics.groups.visibility=$private.visibility.isElementOnScreen(element).toString();};$private.addGroupsGeolocation=function(ad){var gps=$private.gpsCookie("geoloc");if(gps&&gps.length===5){ad.metrics.groups.city=gps[3];ad.metrics.groups.state=gps[4];}};$private.gpsCookie=function(gpsCookieName){var gps=$private.cookieUtils.getItem(gpsCookieName);if(!$private.typeValidator.isString(gps)){return;}return unescape(gps).split(",");};$private.addMeasuresTime=function(ad){ad.metrics.measures={"executionTime":ad.executionTime,"timeStampInit":ad.timeStampInit,"timeStampEnd":ad.timeStampEnd,"LoadTime":ad.loadTime};};$private.calculateAverageSlotsLoadTime=function(adLoadTime){window.__countRenderedSlots=window.__countRenderedSlots||0;window.__countRenderedSlots++;window.__slotsLoadTime=window.__slotsLoadTime||0;window.__slotsLoadTime+=adLoadTime;window.__averageSlotsLoadTime=window.__slotsLoadTime/window.__countRenderedSlots;};$private.enableAdRefresh=function(ad,refreshInterval){if(ad.refreshTimer){ad.refreshTimer.stop();ad.isRefreshing=false;}else{refreshInterval=refreshInterval*1000;ad.refreshTimer=new TimeoutUtils($private.refreshSlotCallback(ad.config.bannerId),refreshInterval);$private.visibility.addElement(ad.config.bannerId,false,$private.refreshPlayCallback(ad),$private.refreshPauseCallback(ad));}};$private.refreshSlotCallback=function(id){return function(){$public.refreshSlot(id);};};$public.getAdSize=function(bannerId){if(!$private.typeValidator.isString(bannerId)){$public.logger.debug("O ID passado para o método getAdSize não é uma string válida");return;}var ad=$private.getAdById(bannerId);if(!$private.isValidAdSize(ad)){$public.logger.debug("Não foi retornado nenhum tamanho com esse ID");return;}return ad.size;};$private.isValidAdSize=function(ad){if(!$private.typeValidator.isObject(ad)){return false;}if(!$private.typeValidator.isObject(ad.size)){return false;}if(!$private.typeValidator.isNumber(ad.size.width)){return false;}if(!$private.typeValidator.isNumber(ad.size.height)){return false;}return true;};$private.refreshPlayCallback=function(ad){return function(){if(ad.isRefreshing||!ad.refreshTimer){return;}ad.isRefreshing=true;ad.refreshTimer.play();$public.logger.debug("O recarregamento ativado para o anúncio de id "+ad.config.bannerId+" será feito em "+ad.refreshTimer.getRemaining()+"ms");};};$private.refreshPauseCallback=function(ad){return function(){if(!ad.isRefreshing||!ad.refreshTimer){return;}ad.isRefreshing=false;if(ad.refreshTimer.getRemaining()<1){ad.refreshTimer.stop();}else{ad.refreshTimer.pause();$public.logger.debug("Pausando o timeout do recarregamento do anúncio de id "+ad.config.bannerId+" pois o anúncio não está visível, tempo restante:"+ad.refreshTimer.getRemaining()+"ms");}};};$private.requestAd=function(ad){window.googletag.display(ad.config.bannerId);if(window.dontRefresh){return;}window.__batchDfpRequest=window.__batchDfpRequest||[];window.__batchDfpRequest.push(ad.slot);window.__averageExecutionTime=$public.updateAverageExecutionTime(ad.executionTime);var timeoutTime=window.__averageExecutionTime*100;if(timeoutTime>3000){timeoutTime=3000;}$public.logger.debug("[SRA] Adicionando o anúncio: "+ad.config.bannerId+'" a um grupo com '+window.__batchDfpRequest.length+" anúncios com um delay de "+timeoutTime+"ms");if(window.batchTimeout){window.batchTimeout.updateDelay(timeoutTime);}else{window.batchTimeout=new TimeoutUtils($private.showSingleRequestAds,timeoutTime);window.batchTimeout.play();}};$private.showSingleRequestAds=function(timeoutUtils){delete window.batchTimeout;var slots=window.__batchDfpRequest;if(slots.length<1){return;}window.googletag.pubads().refresh(slots,{changeCorrelator:false});delete window.__batchDfpRequest;$public.logger.debug("[SRA] Foram exibidos: "+slots.length+" anúncios depois de um timeout de "+timeoutUtils.getDelay()+"ms");};$public.updateAverageExecutionTime=function(executionTime){window.__executionTime=window.__executionTime||0;if(executionTime>100){return window.__averageExecutionTime||100;}window.__executionTime+=executionTime;window.__countExecutions=window.__countExecutions||0;window.__countExecutions++;return window.__executionTime/window.__countExecutions;};$public.handleRefresh=function(id,action){if(!$private.typeValidator.isString(id)){$public.logger.warn('Um id deve ser do tipo "String"',$private.namTag,$private.namespace,$private.calculateTimeSpent());return;}var ad=$private.getAdById(id);if(!ad){return;}if(action=="pause"){delete ad.refreshTimer;$public.logger.debug('Removendo o refresh do anúncio de id "'+id+'".');return;}var timeToRefresh=parseInt(ad.config.timeToRefresh);$private.enableAdRefresh(ad,timeToRefresh);$public.logger.debug('Redefinindo o tempo de refresh do anúncio de id "'+id+'" para '+ad.config.timeToRefresh+"ms");};$public.removeAds=function(ids){if($private.typeValidator.isString(ids)){ids=[ids];}if(!$private.typeValidator.isArray(ids)){$public.logger.debug('O id deve ser do tipo "Array"');return;}for(var i=0;i<ids.length;i++){if(!$private.typeValidator.isString(ids[i])){continue;}var ad=$private.getAdById(ids[i]),result;if(ad){result=(new Slot()).destroySlots([ad.slot]);if(result){$private.removeAdConfigured(ids[i]);}}}};$private.removeAdConfigured=function(id){var __configuredDFPTags=window.__configuredDFPTags;for(var key in __configuredDFPTags){var configuredTag=__configuredDFPTags[key];for(var ad in configuredTag.ads){if(ad===id){delete configuredTag.ads[id];}}}};return $private.__constructor();}var namespace=new NameSpace("DfpAsync");var visibility=new Visibility();namespace.init=function(config,namTag){var dfpAsync=new DfpAsync();namespace.addPubadsEvent=dfpAsync.addPubadsEvent;namespace.refreshSlot=dfpAsync.refreshSlot;namespace.getAdSize=dfpAsync.getAdSize;namespace.handleRefresh=dfpAsync.handleRefresh;namespace.addRenderingCallback=dfpAsync.addRenderingCallback;namespace.removeAds=dfpAsync.removeAds;return dfpAsync.init(config,namTag,"DfpAsync");};var __monitoracaoJsuol="tm.jsuol.com.br/modules/dfp-async.js";})(window,document);(function(window,document,undefined){var ModuleSchema={properties:{type:"stringMatches|/(script|iframe|img)/",javascriptSource:"isString",src:"isString",container:"isString",width:"stringMatches|/^[\\d|null]+(px|%){0,1}$/",height:"stringMatches|/^[\\d|null]+(px|%){0,1}$/"},required:["type"]};function ModuleAsyncWriter(){var $private={};var $public=this;$public.logger=new Logs();$public.trackManager=new TrackManager();$private.schema=new Schema(ModuleSchema);$private.typeValidator=new TypeValidator();$public.__constructor=(function(){$public.logger.setPrefix("UOLPD.TagManager.ModulesInjectorAsync");$public.trackManager.setModuleName("modules-injector-async");})();$public.init=function(config,namTag,namespace){$private.configureLogger(namTag,namespace);$public.trackManager.trackSuccess("Execucoes Iniciadas");if($private.schema.isValid(config)){config=$private.fixConfig(config);if(!$private.isInvalidSrc(config)){$private.createModule(config);}}else{$private.logInvalidConfig();}};$private.configureLogger=function(namTag,namespace){$private.namTag=namTag;$private.namespace=namespace;$private.timeStampInit=Date.now();};$private.fixConfig=function(config){if(config.javascriptSource){config.src=config.javascriptSource;}if(config.type=="javascript"){config.type="script";}return config;};$private.isInvalidSrc=function(config){if(!$private.typeValidator.isString(config.src)&&!$private.typeValidator.isString(config.javascriptSource)){return true;}return false;};$private.calculateTimeSpent=function(timeStampInit){if(!$private.typeValidator.isDefined(timeStampInit)){return Date.now()-$private.timeStampInit;}return Date.now()-timeStampInit;};$private.createModule=function(config){if($private.pageHasElement(config.type,config.src)){$public.logger.warn("Um "+config.type+' com src "'+config.src+'" já existe nesta página, verifique suas configurações.',$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("repeated_element","fluxo_interrompido");return;}$public.element=$private.createElement(config);$private.appendElement($public.element,config.container);$private.executionTime=$private.calculateTimeSpent();$public.logger.log("O "+config.type+" foi criado de forma assíncrona",$private.namTag,$private.namespace,$private.executionTime);$public.trackManager.trackSuccess("Execucoes Finalizadas");};$private.pageHasElement=function(elementType,src){var selector=elementType+"["+'src*="'+$private.stripProtocol(src)+'"]';return document.querySelector(selector);};$private.stripProtocol=function(src){return src.substring(src.indexOf("//"),src.length);};$private.createElement=function(config){var element=document.createElement(config.type);element.src=$private.replaceMacros(config.src);element.async="true";if(config.type==="img"){element=$private.addSize(element,config.width,config.height);}if(config.type==="iframe"){element=$private.addAttrIframe(element,config.width,config.height);}element.onload=$private.addMetrics;element.onerror=$private.addMetrics;return element;};$private.replaceMacros=function(src){src=src.replace(/%%CACHE_BUSTER%%/g,$private.timeStampInit);try{src=$private.replaceTailTargetData(src);return $private.replaceWithDataLayerItens(src);}catch(e){return src;}};$private.replaceTailTargetData=function(src){if(src.indexOf("%%TT-DATA%%")<0){return src;}return src.replace(/%%TT-DATA%%/gi,$private.getTailTargetData());};$private.getTailTargetData=function(){var url=[],dataLayer=window.UOLPD.dataLayer;for(var key in dataLayer){if(/^tt\_\w+$/gi.test(key)){var item=key.replace("_","-");url.push(item+"="+dataLayer[key]);}}return url.join(";");};$private.replaceWithDataLayerItens=function(src){var pattern=/%%dataLayer_(\w+)%%/gi;var matches=pattern.exec(src);while(matches!==null){var dataLayerValue=$private.getItemFromDataLayer(matches[1]);if(dataLayerValue){src=src.replace(new RegExp(matches[0],"g"),dataLayerValue);}matches=pattern.exec(src);}return src;};$private.getItemFromDataLayer=function(item){if(!$private.typeValidator.isString(item)){return;}var dataLayer=window.UOLPD.dataLayer;for(var key in dataLayer){if(key.toLowerCase()===item.toLowerCase()){return dataLayer[key];}}return;};$private.addSize=function(element,width,height){if(width){element.width=width.match(/^\d+/g);}if(height){element.height=height.match(/^\d+/g);}return element;};$private.addAttrIframe=function(element,width,height){if(height){element.height=height;}element.width=width||"100%";element.scrolling="no";element.frameBorder=0;return element;};$private.addMetrics=function(){$public.trackManager.trackCustomObj($private.getExecutionMetrics());};$private.getExecutionMetrics=function(){var metrics={};metrics.groups={};metrics.groups.namTag=$private.namTag;metrics.measures={};var loadTime=$private.calculateTimeSpent($private.loadTimeInit);if($private.isOutsideTime(loadTime,21000)||$private.isOutsideTime($private.executionTime,1000)){metrics.groups.groupType=2;metrics.measures.OutsideTime=1;}else{metrics.groups.groupType=1;metrics.measures.Execution=1;}metrics.measures.executionTime=$private.executionTime;metrics.measures.LoadTime=loadTime;return metrics;};$private.isOutsideTime=function(time,maxTime){if(isNaN(time)||time<0||time>maxTime){return true;}return false;};$private.appendElement=function(element,selector,count){count=count||1;if(count>=100||!selector){selector="body";}var container=document.querySelector(selector);if(container){container.appendChild(element);$private.loadTimeInit=Date.now();}else{window.setTimeout(function(){count++;$private.appendElement(element,selector,count);},50);}};$private.logInvalidConfig=function(){var invalidProperties=$private.schema.invalidProperties.join(", ");var errorMessage="A configuração fornecida pelo Tag Manager está inválida, as seguintes propriedades: "+invalidProperties+" não existem ou são inválidas";$public.logger.error(errorMessage,$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackError("invalid_config","O objeto de configuração está inválido");};}var __monitoracaoJsuol="tm.jsuol.com.br/modules/modules-injector-async.js";var namespace=new NameSpace("ModulesInjectorAsync");namespace.init=function(config,namTag){return(new ModuleAsyncWriter()).init(config,namTag,"ModulesInjectorAsync");};})(window,document);(function(window,document,undefined){function UolDna(){var $private={};var $public=this;$public.logger=new Logs();$public.logger.setPrefix("UOLPD.TagManager.DNA");$public.trackManager=new TrackManager();$public.trackManager.setModuleName("dna");$private.src="//tm.uol.com.br/uoldna.html";$public.init=function(namTag,namespace){$public.trackManager.trackSuccess("Execucoes Iniciadas");$private.configureLogger(namTag,namespace);if($private.stopFlow()){return;}$public.setIframe();$private.appendIframe();};$private.configureLogger=function(namTag,namespace){$private.namTag=namTag;$private.namespace=namespace;$private.timeStampInit=Date.now();};$private.stopFlow=function(){var tt_uid;try{tt_uid=window.localStorage.getItem("tt_uid");}catch(err){}if(tt_uid){$public.logger.log("O UOL DNA já foi realizado na página",$private.namTag,$private.namespace,$private.calculateTimeSpent());$public.trackManager.trackCustom("Execucoes Finalizadas","fluxo","2");return true;}if($private.isIframeInPage()){$public.trackManager.trackError("duplicate-call","fluxo_interrompido");$public.logger.warn("Já existe o iframe com o src do DNA na página",$private.namTag,$private.namespace,$private.calculateTimeSpent());return true;}return false;};$private.isIframeInPage=function(){if(document.querySelector('[src*="'+$private.src+'"]')){return true;}return false;};$private.calculateTimeSpent=function(){return Date.now()-$private.timeStampInit;};$public.getIframe=function(){return $private.iframe;};$public.setIframe=function(){$private.iframe=document.createElement("iframe");$private.iframe.style.display="none";$private.iframe.setAttribute("src","https:"+$private.src);$private.iframe.onload=$private.addMetrics;$private.iframe.onerror=$private.addMetrics;};$private.addMetrics=function(){$public.trackManager.trackCustomObj($private.getExecutionMetrics());};$private.getExecutionMetrics=function(){var metrics={};metrics.groups={};metrics.groups.namTag=$private.namTag;metrics.measures={};var loadTime=$private.calculateTimeSpent($private.loadTimeInit);if($private.isOutsideTime(loadTime,21000)||$private.isOutsideTime($private.executionTime,1000)){metrics.groups.groupType=2;metrics.measures.OutsideTime=1;}else{metrics.groups.groupType=1;metrics.measures.Execution=1;}metrics.measures.executionTime=$private.executionTime;metrics.measures.LoadTime=loadTime;return metrics;};$private.isOutsideTime=function(time,maxTime){if(isNaN(time)||time<0||time>maxTime){return true;}return false;};$private.appendIframe=function(){if(!document.body){setTimeout($private.appendIframe,100);}else{document.body.appendChild($private.iframe);$private.loadTimeInit=Date.now();$private.executionTime=$private.calculateTimeSpent();$public.logger.log("O iframe do UOL DNA foi incluído com sucesso",$private.namTag,$private.namespace,$private.executionTime);$public.trackManager.trackCustom("Execucoes Finalizadas","fluxo","1");}};}var nameSpace=new NameSpace("DNA");nameSpace.init=function(config,namTag){return(new UolDna()).init(namTag,"DNA");};})(window,document);var defaultTags=[{"name":"UOL DNA","module":"DNA","rules":{"enable":["/\\.uol\\.com\\.br/.test(window.location.href)"],"disable":[]},"events":["onload"]},{"name":"Behavioural Targeting","module":"CodeInjector","rules":{"enable":["document.location.href.match(/.*/)"],"disable":[]},"events":["onload"],"config":{"codeInjector":"(function() {\n\tvar script = document.createElement('script');\n\tscript.setAttribute('src', '//tracker.bt.uol.com.br/partner?source=tagmanager');\n\tdocument.head.appendChild(script);\n})()"}},{"name":"DynAd/TailTarget Cookie Sync","module":"CodeInjector","rules":{"enable":["document.location.href.match(/.*/)"],"disable":[]},"events":["onload"],"config":{"codeInjector":'(function (RemoteStorage) {\n    function UserIdentifier () {\n        var $private = {};\n        var $public = this;\n\n        $private.remoteStorage = new RemoteStorage();\n        $private.ttSource = \'//m.t.tailtarget.com/sync/TT-10162-1/\';\n        $private.types = [\'email\', \'cpf\'];\n        $private.uid = {};\n        $private.dna = null;\n\n        $public.init = function () {\n            $private.remoteStorage.get(\'DNA\', $private.requestDNA);\n        };\n\n        $private.requestDNA = function (key, dnaID) {\n            if (!dnaID) {\n                dnaID = $private.getCookie("DNA");\n            }\n\n            $private.dna = dnaID.split("|")[0];\n            $private.uid.dna = $private.dna;\n\n            $private.setDynAdIframes();\n        };\n\n        $private.setDynAdIframes = function () {\n            var ttIframes = $private.getIframeBySrc($private.ttSource);\n            $private.types = (ttIframes.length > 1) ? $private.types : [\'hash\'];\n\n            for (var i = 0; i < ttIframes.length; i++) {\n                var ttIframe = ttIframes[i];\n\n                var type = $private.types[i];\n                var hash = ttIframe.getAttribute(\'src\').match(/.*m\\.t.tailtarget\\.com\\/sync\\/TT-10162-1\\/([\\w]+)/)[1];\n\n                $private.uid[type] = hash;\n\n                var dynadSrc = $private.buildDynadURL(hash, type, $private.dna);\n                if ($private.hasIframe(dynadSrc)) {\n                    continue;\n                }\n\n                $private.setIframe(dynadSrc);\n            }\n\n            $private.remoteStorage.set(\'UID\', JSON.stringify($private.uid), function () {});\n        };\n\n        $private.getCookie = function (name) {\n            var initialRange = document.cookie.indexOf(name + "=");\n            if (initialRange < 0) {\n                return \'null\';\n            }\n            var middleRange = document.cookie.indexOf("=", initialRange) + 1;\n            var finalRange = document.cookie.indexOf(";", middleRange);\n            if (finalRange < 0) {\n                finalRange = document.cookie.length;\n            }\n            return decodeURIComponent(document.cookie.substring(middleRange, finalRange));\n        };\n\n        $private.hasIframe = function (src) {\n            return $private.getIframeBySrc(src).length > 0;\n        };\n\n        $private.getIframeBySrc = function (src) {\n            return document.querySelectorAll(\'iframe[src*="\'+ src +\'"]\');\n        };\n\n        $private.setIframe = function (src) {\n            var iframe = document.createElement("iframe");\n            iframe.setAttribute("src", src);\n            iframe.setAttribute("frameborder", "0");\n            iframe.style.setProperty("width", "0px");\n            iframe.style.setProperty("height", "0px");\n            iframe.style.setProperty("border", "0px");\n            iframe.style.setProperty("display", "none");\n\n            if (document.body != null) {\n                document.body.appendChild(iframe);\n            }\n        };\n\n        $private.buildDynadURL = function (hash, type, dna) {\n            return "https://z.dynad.net/cd?model=html" +\n                    "&hash=" + hash +\n                    "&type=" + type +\n                    "&source=" + window.location.host +\n                    "&dna=" + dna;\n        };\n\n        $private.persistHashes = function (key, value) {\n            try {\n                value = value || \'{}\'\n                value = JSON.parse(value);\n                value.UID = $private.uid;\n                $private.remoteStorage.set(key, JSON.stringify(value));\n            } catch (err) {}\n        };\n    };\n\n    window.setTimeout(function () { (new UserIdentifier()).init(); }, 0);\n})(UOLPD.TagManager.Commons.RemoteStorage);'}},{"name":"Purga de clients de RT expirados","module":"CodeInjector","rules":{"enable":["document.location.href.match(/.*/)"],"disable":[]},"events":["onload"],"config":{"codeInjector":"(function () {\n    var createIframe = function (name, expname, expdomain) {\n        var iframe = document.createElement('iframe');\n        iframe.style.width = '0';\n        iframe.style.heigth = '0';\n        iframe.style.display = 'none';\n        iframe.style.opacity = '0';\n        iframe.style.border = '0';\n        iframe.setAttribute('src', 'https://tm.uol.com.br/purge-clients.html?name=' + name + '&expname=' + expname + '&expdomain=' + expdomain);\n        document.body.appendChild(iframe);\n    };\n    \n    createIframe('DEretargeting', 'DEretargetingExp', '1');\n    createIframe('dynad_rt', 'dynad_rt_exp', '1');\n})();"}}];function VersionManager(){var $private={};var $public=this;$public.logger=new Logs();$private.validator=new TypeValidator();$private.stringUtils=new StringUtils();$private.scriptUtils=new ScriptUtils();$private.tmVersionToken="uoltm_version";$public.setSpecificVersion=function(){if(!$public.specificVersionWasRequested()){return;}$private.scriptUtils.createSyncScript($public.getSpecificVersionURL());};$public.specificVersionWasRequested=function(){var requestedVersion=$private.getRequestedVersion();var versionRegex=/^\d+$/gm;var isValidVersion=versionRegex.test(requestedVersion);if(!requestedVersion||!isValidVersion){return false;}if($private.hasVersionScriptInPage()){return false;}return true;};$public.getSearch=function(){return window.location.search;};$public.getScriptUrl=function(){var __monitoracaoJsuol="tm.jsuol.com.br/37/d0/37d0mn.js";return __monitoracaoJsuol;};$public.getSpecificVersionURL=function(){var codRepository=$private.getCodRepository();var versionURL=$private.buildVersionURL(codRepository);return versionURL;};$private.getRequestedVersion=function(){var requestedVersion=$private.stringUtils.getValueFromKeyInString($public.getSearch(),$private.tmVersionToken,"&");return requestedVersion;};$private.hasVersionScriptInPage=function(){var versionURL=$public.getSpecificVersionURL();var scripts=document.querySelectorAll('script[src*="'+versionURL+'"]');if(!scripts||!scripts.length){return false;}return true;};$private.buildVersionURL=function(codRepository){var mainPath="//tm.jsuol.com.br/";var firstDirLevel=codRepository.substring(0,2)+"/";var secondDirLevel=codRepository.substring(2,4)+"/";var fullPath=mainPath+firstDirLevel+secondDirLevel+codRepository;var requestedVersion=$private.getRequestedVersion();if(requestedVersion!="0"){fullPath+="-"+$private.getRequestedVersion()+".js";}else{fullPath+=".js";}return fullPath;};$private.getCodRepository=function(){var baseURLRegex=/[\w\d]{6}\.js$/gm;var codRepository=$public.getScriptUrl().match(baseURLRegex,"")[0];codRepository=codRepository.replace(".js","");return codRepository;};}function TagController(){var $private={};var $public=this;$private.typeValidator=new TypeValidator();$private.dataLayer=new DataLayer();$private.executedTags=[];$public.addEvents=function(tag){if(!$private.isTagValid(tag)){return;}for(var i=0,length=tag.events.length;i<length;i++){if($private.typeValidator.isString(tag.events[i])){$private.addEvent(tag.events[i],tag);}}};$private.isTagValid=function(tag){if(!$private.typeValidator.isObject(tag)){return false;}if(!$private.typeValidator.isString(tag.module)){return false;}if(!$private.typeValidator.isObject(tag.rules)){return false;}if(!$private.typeValidator.isArray(tag.rules.enable)){return false;}if(!$private.typeValidator.isArray(tag.rules.disable)){return false;}if(!$private.typeValidator.isArray(tag.events)){return false;}if(tag.config&&!$private.typeValidator.isObject(tag.config)){return false;}return true;};$public.getEvents=function(eventName){return $private.events;};$private.addEvent=function(eventName,tag){$private.events=$private.events||{};var events=$private.events[eventName]||[];events.push($private.cloneTag(tag,eventName));$private.events[eventName]=events;};$private.cloneTag=function(tag,eventName){var result={};for(var key in tag){result[key]=tag[key];}if($private.typeValidator.isString(tag.module)){result.moduleName=tag.module;result.module=$public.getModuleByName(tag.module);result.event=[eventName];}return result;};$public.getModuleByName=function(moduleName){var module;if(!$private.typeValidator.isString(moduleName)){return;}module=window.UOLPD.TagManager[moduleName];if(!$private.typeValidator.isDefined(module)){return;}module.nameSpace=moduleName;if($private.typeValidator.isFunction(module.init)){return module;}};$public.triggerEvents=function(eventName){var currentEvent=$public.getCurrentEvent(eventName);if(!currentEvent){return;}for(var i=0,length=currentEvent.length;i<length;i++){try{$private.activateTag(currentEvent[i],eventName);}catch(e){}}};$public.getCurrentEvent=function(eventName){if(!$private.events){return;}var currentEvent=$private.events[eventName];if($private.typeValidator.isArray(currentEvent)){return currentEvent;}};$private.activateTag=function(tag,eventName){if($private.isTagEnabled(tag)){tag.module.init(tag.config,tag.name);$private.executedTags.push(tag);$private.dataLayer.setDataLayer(tag.module.nameSpace);}};$private.isTagEnabled=function(tag){if($private.checkRules(tag.rules.disable)){return false;}if($private.checkRules(tag.rules.enable)){return true;}};$private.checkRules=function(rules){try{if(eval(rules.join(" || "))){return true;}}catch(e){return false;}};$public.getExecutedTags=function(){return $private.executedTags;};}function BehaviouralTargeting(){var $private={};var $public=this;$private.validator=new TypeValidator();$private.cookieUtils=new CookieUtils();$private.remoteStorage=new RemoteStorage();$public.getBTCookies=function(){var rtCodes=$private.getMergeCookies();var dntTrack=$public.getDoNotTrack();rtCodes.push(dntTrack);return rtCodes;};$private.getMergeCookies=function(){var BTCookie=$private.getClientsArray($private.cookieUtils.getItem("BT"));var DECookie=$private.getClientsArray($private.cookieUtils.getItem("DEretargeting"));return $private.mergeCookies(BTCookie,DECookie);};$private.getClientsArray=function(cookie){if(!$private.validator.isString(cookie)){return[];}if(cookie.length===0){return[];}var retargeting=cookie.split(";").sort();for(var i=0;i<retargeting.length;i++){var arr=retargeting[0];if(arr===""){retargeting.splice(0,1);}}return retargeting;};$private.mergeCookies=function(deRetar,bt){var retargeting=deRetar.concat(bt).sort();for(var i=0;i<retargeting.length;i++){if(retargeting[i]===retargeting[i+1]){retargeting.splice(i,1);}}return retargeting;};$public.getDoNotTrack=function(){var dntCode="9000";if(!navigator.doNotTrack&&!window.doNotTrack&&!navigator.MsDoNotTrack){dntCode="9000";return dntCode;}if(navigator.doNotTrack==="1"||window.doNotTrack==="1"||navigator.MsDoNotTrack==="1"){dntCode="9001";return dntCode;}if(navigator.doNotTrack==="yes"){dntCode="9003";return dntCode;}return dntCode;};}function DataLayer(){var $private={};var $public=this;$public.logs=new Logs();$public.logs.setPrefix("UOLPD.TagManager");$private.typeValidator=new TypeValidator();$private.remoteStorage=new RemoteStorage();$private.cookieUtils=new CookieUtils();$private.behaviouralTargeting=new BehaviouralTargeting();$public.__constructor=(function(){$private.remoteStorage.get("uolDataLayer",function(key,value){try{window.localStorage.setItem("uolDataLayer",value);}catch(e){}});})();$public.createDataLayer=function(){var namespace=window.UOLPD;if(!$private.typeValidator.isObject(namespace)){window.UOLPD={};}var dataLayer=window.UOLPD.dataLayer;if(!$private.typeValidator.isObject(dataLayer)){window.UOLPD.dataLayer={};}$private.addReferrer();$private.addOrigin();$private.addFocusStatus();$private.addBT();};$private.addReferrer=function(){window.UOLPD.dataLayer.referrer=window.UOLPD.dataLayer.referrer||$private.cleanSpecialChars($public.getReferrer());};$private.cleanSpecialChars=function(text){return text.replace(/(^https?:\/\/|["'=!+#\*~;^\(\)<>\[\],&\\\/\.\:\-\_\?])+/gm,function(match,offset,string){var isProtocol=(/https?:\/\//g).test(match);var isLastChar=offset===(string.length-1);return(isProtocol||isLastChar)?"":" ";}).replace(/\s{2,}/g," ");};$public.getReferrer=function(){return document.referrer;};$private.addOrigin=function(){window.UOLPD.dataLayer.origin=window.UOLPD.dataLayer.origin||$private.cleanSpecialChars($public.getOrigin());};$public.getOrigin=function(){if(!$private.isOnMainPage()){return document.referrer;}return window.location.href;};$private.isOnMainPage=function(){if(window.top!=self){return false;}return true;};$private.addFocusStatus=function(){$private.updateFocus();setInterval(function(){$private.updateFocus();},750);};$private.updateFocus=function(){try{window.UOLPD.dataLayer.hasFocus=window.parent.top.document.hasFocus().toString();}catch(err){$public.logs.error(err.name+": "+err.message);}};$private.addBT=function(){var values=[];if($private.typeValidator.isString(window.UOLPD.dataLayer.bt)){values=window.UOLPD.dataLayer.bt.split(",");}var cookieValues=$private.behaviouralTargeting.getBTCookies();if($private.typeValidator.isArray(cookieValues)){values=$private.mergeArrays(values,cookieValues);}if(values.length>0){window.UOLPD.dataLayer.bt=values.toString();}};$private.mergeArrays=function(dataLayerItems,cookieItems){var finalArray=[];finalArray=$private.addValidItems(dataLayerItems,finalArray);finalArray=$private.addValidItems(cookieItems,finalArray);return finalArray;};$private.addValidItems=function(dataArray,targetArray){if(!$private.typeValidator.isArray(dataArray)){return targetArray;}for(var i=0,length=dataArray.length;i<length;i++){var item=dataArray[i];if(!$private.typeValidator.isString(item)){continue;}if(targetArray.indexOf(item)<0){targetArray.push(item);}}return targetArray;};$public.setDataLayer=function(module){var dataLayer=$private.hasModuleDataLayer(module);if(!$private.typeValidator.isObject(dataLayer)){return;}for(var key in dataLayer){window.UOLPD.dataLayer[key]=dataLayer[key];$public.logs.debug('Foi adicionado "'+key+" : "+dataLayer[key]+'" à window.UOLPD.dataLayer pelo módulo: '+module);}$private.addBT();};$private.hasModuleDataLayer=function(module){var data={};try{data=JSON.parse(window.localStorage.getItem("uolDataLayer"));}catch(e){}if(!$private.typeValidator.isObject(data)){return;}if(!$private.typeValidator.isString(module)){return;}var dataLayer=data[module];if(!$private.typeValidator.isObject(dataLayer)){return;}return dataLayer;};}function UniqueId(){var $private={};var $public=this;$public.logs=new Logs();$public.logs.setPrefix("UOLPD.TagManager");$private.typeValidator=new TypeValidator();$private.remoteStorage=new RemoteStorage();$private.setUniqueId=function(value){var uniqueId=[];if(!$private.typeValidator.isObject(value)){return;}if($private.typeValidator.isString(value.dna)){uniqueId.push("1|"+value.dna);}if($private.typeValidator.isString(value.email)){uniqueId.push("2|"+value.email);}if($private.typeValidator.isString(value.cpf)){uniqueId.push("3|"+value.cpf);}if(uniqueId.length>0){window.localStorage.setItem("tt_uid",uniqueId.join(";"));}};$public.__constructor=(function(){$private.remoteStorage.get("UID",function(key,value){try{$private.setUniqueId(JSON.parse(value));}catch(e){}});})();}function TMConsole(codRepository,version){var $private={};var $public=this;$public.logger=new Logs();$public.logger.setPrefix("UOLPD.TagManager");$private.typeValidator=new TypeValidator();$private.cookieUtils=new CookieUtils();$private.cookieName="uoltm_version";$public.__constructor=function(codRepository,version){if(!$private.isValidConstructorArguments(codRepository,version)){return;}if($private.hasOtherRepositoryCookie(codRepository)){return;}if(!$private.cookieUtils.getItem($private.cookieName)){$private.cookieUtils.setItem($private.cookieName,codRepository,null,0,0,15);}$private.appendOnDocComplete(codRepository,version);return $public;};$private.appendOnDocComplete=function(codRepository,version){$private.container=$private.createMainContainer(codRepository,version);if(document.readyState==="complete"){document.body.appendChild($private.container);return;}var method=(document.addEventListener)?"readystatechange":"onreadystatechange";var methodListener=(document.addEventListener)?"addEventListener":"attachEvent";document[methodListener](method,function(){if(document.readyState==="complete"){document.body.appendChild($private.container);}});};$private.isValidConstructorArguments=function(codRepository,version){if(!$private.typeValidator.isString(codRepository)){$public.logger.error("O parâmetro fornecido como código do repositório é inválido");return false;}if(!$private.typeValidator.isNumericString(version)){$public.logger.error("O parâmetro fornecido como versão do repositório é inválido");return false;}return true;};$private.hasOtherRepositoryCookie=function(codRepository){var currentCookie=$private.cookieUtils.getItem($private.cookieName);if($private.typeValidator.isString(currentCookie)&&currentCookie!==codRepository){return true;}return false;};$private.createMainContainer=function(codRepository,version){var mainContainer=document.createElement("div");mainContainer.setAttribute("id",codRepository);mainContainer.style.backgroundColor="#fafafa";mainContainer.style.bottom=0;mainContainer.style.display="block";mainContainer.style.height=Math.round(window.innerHeight/3)+"px";mainContainer.style.position="fixed";mainContainer.style.width="100%";mainContainer.style.fontFamily="Verdana, Sans-serif";mainContainer.style.zIndex="99999999999";mainContainer.appendChild($private.createHeaderContainer(codRepository,version));mainContainer.appendChild($private.createLogContainer());return mainContainer;};$private.createHeaderContainer=function(codRepository,version){var headerContainer=document.createElement("div");headerContainer.style.width="100%";headerContainer.style.borderTop="solid 0.5px #aaaaaa";headerContainer.style.color="#757575";headerContainer.style.position="relative";headerContainer.appendChild($private.createLogo());headerContainer.appendChild($private.createRepositoryInfo(codRepository,version));headerContainer.appendChild($private.createCloseButton(codRepository));headerContainer.appendChild($private.createControlButton(codRepository));return headerContainer;};$private.createLogo=function(){var logo=$private.createHeaderSubDivision();logo.appendChild($private.createLogoAnchor());return logo;};$private.createHeaderSubDivision=function(){var headerSubDivision=document.createElement("div");headerSubDivision.style.display="inline-block";headerSubDivision.style.padding="5px";return headerSubDivision;};$private.createLogoAnchor=function(){var anchor=document.createElement("a");anchor.setAttribute("href","//tagmanager.uol.com.br");anchor.style.backgroundImage="url(//imguol.com.br/tag-manager/icons-sprite.png)";anchor.style.backgroundPosition="0 0";anchor.style.backgroundRepeat="no-repeat";anchor.style.width="155px";anchor.style.height="38px";anchor.style.display="block";anchor.style.textIndent="100%";anchor.style.whiteSpace="nowrap";anchor.style.overflow="hidden";anchor.setAttribute("title","Logo do console do UOL Tag Manager");var h1=document.createElement("h1");h1.innerHTML="UOL Tag Manager";anchor.appendChild(h1);return anchor;};$private.createRepositoryInfo=function(codRepository,version){var repositoryInfo=$private.createHeaderSubDivision();var repositoryName=$private.createRepositoryName("Trip");codRepository=$private.createHeaderSubText(codRepository);version=$private.createHeaderSubText("Versão "+version);version.style.marginLeft="28px";repositoryInfo.innerHTML=repositoryName.outerHTML+"-"+codRepository.outerHTML+version.outerHTML;repositoryInfo.style.position="absolute";repositoryInfo.style.left=Math.round(window.innerWidth/3)+"px";repositoryInfo.style.marginRight="40px";return repositoryInfo;};$private.createRepositoryName=function(name){var h2=document.createElement("h2");h2.style.margin="0px 5px 0px 0px";h2.style.padding="0px";h2.style.fontWeight="lighter";h2.style.display="inline";h2.style.color="#757575";h2.style.fontSize="27px";h2.innerHTML=name;return h2;};$private.createHeaderSubText=function(innerText){var h4=document.createElement("h4");h4.style.margin="0px 0px 0px 5px";h4.style.padding="0px";h4.style.display="inline";h4.style.fontWeight="lighter";h4.style.color="#757575";h4.style.fontSize="17px";h4.innerHTML=innerText;return h4;};$private.createLogContainer=function(){var logContainer=document.createElement("div");logContainer.style.overflowX="hidden";logContainer.style.overflowY="auto";logContainer.style.height=(Math.round(window.innerHeight/3)-49)+"px";logContainer.setAttribute("class","logContainer");var table=document.createElement("table");table.style.width="100%";table.style.textAlign="left";table.style.borderCollapse="collapse";table.style.marginTop="15px";table.appendChild($private.createThead());table.appendChild($private.createTbody());logContainer.appendChild(table);return logContainer;};$private.createThead=function(){var thead=document.createElement("thead");thead.style.backgroundColor="#FAFAFA";var headers=["","Nome da Tag","Módulo","Mensagem","Tempo de execução"];for(var i=0,length=headers.length;i<length;i++){var th=document.createElement("th");th.style.fontWeight="lighter";th.style.color="#757575";th.style.padding="5px 0px";th.style.fontSize="17px";th.innerHTML=headers[i];thead.appendChild(th);}return thead;};$private.createTbody=function(){var tbody=document.createElement("tbody");tbody.setAttribute("class","log-messages");return tbody;};$private.createCloseButton=function(codRepository){var anchor=document.createElement("a");anchor.style.backgroundImage="url('//imguol.com.br/tag-manager/icons-sprite.png')";anchor.style.backgroundPosition="-102px -49px";anchor.style.backgroundRepeat="no-repeat";anchor.style.height="15px";anchor.style.width="15px";anchor.style.display="inline-block";anchor.style.position="absolute";anchor.style.right="12px";anchor.style.marginTop="14px";anchor.style.cursor="pointer";anchor.setAttribute("title","Fechar o console do UOL Tag Manager");$private.applyEventClosed(anchor,codRepository);return anchor;};$private.applyEventClosed=function(element,codRepository){var methodListener=(document.addEventListener)?"addEventListener":"attachEvent";var nameEvent=(document.addEventListener)?"click":"onclick";element[methodListener](nameEvent,function(e){e.preventDefault();e.stopPropagation();$private.close(codRepository);});};$private.createControlButton=function(codRepository){var ctrlButton=document.createElement("a");ctrlButton.style.backgroundImage="url(//imguol.com.br/tag-manager/icons-sprite.png)";ctrlButton.style.backgroundPosition="-122px -49px";ctrlButton.style.backgroundRepeat="no-repeat";ctrlButton.style.height="25px";ctrlButton.style.width="25px";ctrlButton.style.display="inline-block";ctrlButton.style.position="absolute";ctrlButton.style.right="30px";ctrlButton.style.marginTop="14px";ctrlButton.style.cursor="pointer";ctrlButton.className="maximized";ctrlButton.setAttribute("title","Minimizar o console do UOL Tag Manager");$private.applyEventControlButton(ctrlButton,codRepository);return ctrlButton;};$private.applyEventControlButton=function(element,codRepository){var methodListener=(document.addEventListener)?"addEventListener":"attachEvent";var nameEvent=(document.addEventListener)?"click":"onclick";element[methodListener](nameEvent,function(event){event.preventDefault();event.stopPropagation();$private.controlConsole(event.target,codRepository);});};$private.close=function(codRepository){var mainContainer=document.getElementById(codRepository);if(mainContainer){mainContainer.style.display="none";}document.cookie=$private.cookieName+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/";};$private.controlConsole=function(target,codRepository){var className=target.className;var mainContainer=document.getElementById(codRepository);if(!mainContainer){return false;}target.classList.remove(className);if(className==="minimized"){mainContainer.style.height=Math.round(window.innerHeight/3)+"px";target.classList.add("maximized");target.style.backgroundPosition="-122px -49px";target.setAttribute("title","Minimizar o console do UOL Tag Manager");}else{if(className==="maximized"){mainContainer.style.height="50px";target.classList.add("minimized");target.style.backgroundPosition="-78px -49px";target.setAttribute("title","Maximizar o console do UOL Tag Manager");}else{return false;}}};$public.append=function(namTag,namespace,message,executionTime,messageType){var logContainer=$private.getLogContainer();if(!logContainer){return false;}if(!$private.isValidLog(namTag,namespace,message,executionTime,messageType)){return false;}logContainer.appendChild($private.createLogLine(namTag,namespace,message,executionTime,messageType));return true;};$private.createLogLine=function(namTag,namespace,message,executionTime,messageType){var logLine=document.createElement("tr");logLine.style.border="solid 0.5px #AAAAAA";logLine.style.backgroundColor="#FFFFFF";var statusIcon=$private.createLogTd($private.createStatusIcon(messageType));statusIcon.style.padding="10px";logLine.appendChild(statusIcon);logLine.appendChild($private.createLogTd(namTag));logLine.appendChild($private.createLogTd(namespace));logLine.appendChild($private.createLogTd(message));logLine.appendChild($private.createLogTd(executionTime+" ms"));return logLine;};$private.getLogContainer=function(){if(!$private.container){return;}var container=$private.findChildByClass($private.container,"logContainer");var tbody=$private.findChildByClass(container.firstChild,"log-messages");if(!tbody){return;}return tbody;};$private.findChildByClass=function(element,className){if(!element){return;}var childNodes=element.childNodes;for(var i=0,length=childNodes.length;i<length;i++){var classes=childNodes[i].getAttribute("class");if(classes&&classes.indexOf(className)>-1){return childNodes[i];}}return;};$private.isValidLog=function(namTag,namespace,message,executionTime,messageType){if(!$private.typeValidator.isString(namTag)){return false;}if(!$private.typeValidator.isString(namespace)){return false;}if(!$private.typeValidator.isString(message)){return false;}if(!$private.typeValidator.isNumber(executionTime)){return false;}if(!$private.isValidMessageType(messageType)){return false;}return true;};$private.isValidMessageType=function(messageType){if(!$private.typeValidator.isString(messageType)){return false;}messageType=messageType.toLocaleLowerCase();if(messageType==="error"){return true;}if(messageType==="warn"){return true;}if(messageType==="success"){return true;}return false;};$private.createStatusIcon=function(messageType){var i=document.createElement("i");i.style.backgroundImage="url(//imguol.com.br/tag-manager/icons-sprite.png)";i.style.backgroundPosition=$private.getStatusIconPosition(messageType);i.style.width="20px";i.style.height="20px";i.style.display="block";i.style.backgroundRepeat="no-repeat";return i.outerHTML;};$private.getStatusIconPosition=function(messageType){messageType=messageType.toLocaleLowerCase();if(messageType=="success"){return"-55px -49px";}if(messageType=="warn"){return"-26px -49px";}if(messageType=="error"){return"-1px -49px";}};$private.createLogTd=function(innerHTML){var td=document.createElement("td");td.style.fontWeight="lighter";td.style.color="#757575";td.style.fontSize="17px";td.style.padding="10px 0px";td.innerHTML=innerHTML;return td;};return $public.__constructor(codRepository,version);}function TagManager(nameSpace,codRepository,version){var $private={};var $public=this;$public.logs=new Logs();$public.logs.setPrefix("UOLPD.TagManager");$private.validator=new TypeValidator();$private.versionManager=new VersionManager();$public.trackManager=new TrackManager();$public.trackManager.setModuleName("core");$private.tagController=new TagController();$public.queryString=new QueryString();$private.cookieUtils=new CookieUtils();$private.dataLayer=new DataLayer();$private.uniqueId=new UniqueId();$private.version="${parent.version}";$private.triggerQueue=[];$public.init=function(tags){$private.timeStampInit=Date.now();$public.trackManager.trackSuccess("Execucoes Iniciadas");$private.startTMConsole();$private.dataLayer.createDataLayer();if(!$private.validator.isArray(tags)){return false;}if($private.versionManager.specificVersionWasRequested()){return $private.versionManager.setSpecificVersion();}tags=tags.concat(defaultTags);$private.cloneTriggerQueue();return $private.createModules(tags);};$private.cloneTriggerQueue=function(){var triggerUOLTM=window.triggerUOLTM;if($private.validator.isArray(triggerUOLTM)){while(triggerUOLTM.length){$private.triggerQueue.push(triggerUOLTM.shift());}}window.triggerUOLTM=$private.triggerUOLTM;window.triggerUOLTM.push=$private.pushTrigger;};$private.createModules=function(tags){var result=true;if(tags.length===0){return false;}while(tags.length){$private.tagController.addEvents(tags.shift());}$private.tagController.triggerEvents("autostart");$private.triggerOnDocComplete();$private.updateEvents();$public.trackManager.trackSuccess("Execucoes Finalizadas");var executionTime=$private.calculateTimeSpent();$public.logs.debug("Tempo de execuçao: "+executionTime);$public.trackManager.trackCustomObj($private.getExecutionMetrics(executionTime));return result;};$private.calculateTimeSpent=function(){return Date.now()-$private.timeStampInit;};$private.getExecutionMetrics=function(executionTime){var metrics={};metrics.measures={};metrics.groups={};metrics.measures.executionTime=executionTime;$private.addTime(metrics);return metrics;};$private.addTime=function(metrics){if(metrics.measures.executionTime<0||metrics.measures.executionTime>1000){metrics.measures.OutsideTime=1;metrics.groups.groupType=2;}else{metrics.measures.Execution=1;metrics.groups.groupType=1;}};$private.triggerOnDocComplete=function(){if(document.readyState==="complete"){$private.tagController.triggerEvents("onload");return;}var method=(document.addEventListener)?"readystatechange":"onreadystatechange";var methodListener=(document.addEventListener)?"addEventListener":"attachEvent";document[methodListener](method,function(){if(document.readyState==="complete"){$private.tagController.triggerEvents("onload");}});};$private.updateEvents=function(){while($private.triggerQueue.length){$private.pushTrigger($private.triggerQueue.shift());}};$private.pushTrigger=function(trigger){if($private.validator.isObject(trigger)){$private.triggerUOLTM(trigger.eventName);return;}$private.triggerUOLTM(trigger);};$private.triggerUOLTM=function(eventType){if(!$private.validator.isString(eventType)){$public.logs.warn("O gatilho solicitado deve ser uma string");return;}if(eventType==="onload"){$public.logs.warn('O gatilho solicitado não pode ser do tipo "onload"');return;}if(eventType==="autostart"){$public.logs.warn('O gatilho solicitado não pode ser do tipo "autostart"');return;}$private.tagController.triggerEvents(eventType);};$public.tagsHistory=function(tagName){return $private.tagController.getTriggerHistory(tagName);};$private.startTMConsole=function(){var queryString=$public.queryString.getValue("uoltm_console");var repositoryCookie=$private.cookieUtils.getItem("uoltm_version");if(queryString===codRepository||repositoryCookie===codRepository){tmConsole=new TMConsole(codRepository,version);}};}var nameSpace=(new NameSpace()).create();nameSpace["37d0mn"]=nameSpace["37d0mn"]||{};nameSpace["37d0mn"].version="12";var tagManager=new TagManager(nameSpace,"37d0mn","12");nameSpace.trigger=tagManager.trigger;tagManager.init([{"module":"Sesame","rules":{"enable":["document.location.href.match(/^http(s)?:\\/\\/revistatrip\\.uol\\.com\\.br(.*)?$/)"],"disable":[]},"events":["autostart"],"config":{},"name":"Sesame"},{"module":"DfpAsync","rules":{"enable":["document.location.href.match(/^http(s)?:\\/\\/revistatrip\\.uol\\.com\\.br(.*)?$/)"],"disable":[]},"events":["autostart"],"config":{"dfppath":"/8804/parceiros/revista_trip","isCompanion":"False","outOfPage":[],"forcePath":[],"nativeType":"1","bannerWidth":"300","pos":"top","expble":"1","campaignuol":"0","geolocation":"True","hide":"False","fluid":[],"isIncremental":"false","bannerId":"banner-300x250-area","bannerHeight":"250","frequencyControl":[],"group":"7,3"},"name":"DFP - Trip - 300x250"},{"module":"DfpAsync","rules":{"enable":["document.location.href.match(/^http(s)?:\\/\\/revistatrip\\.uol\\.com\\.br(.*)?$/)"],"disable":[]},"events":["autostart"],"config":{"dfppath":"/8804/parceiros/revista_trip","isCompanion":"False","outOfPage":[],"forcePath":[],"nativeType":"1","bannerWidth":"728","pos":"top","expble":"1","campaignuol":"0","geolocation":"True","hide":"False","fluid":[],"isIncremental":"false","bannerId":"banner-728x90-area","bannerHeight":"90","frequencyControl":[],"group":"7,3"},"name":"DFP - Trip - 728x90"},{"module":"DfpAsync","rules":{"enable":["document.location.href.match(/^http(s)?:\\/\\/revistatrip\\.uol\\.com\\.br(.*)?$/)"],"disable":[]},"events":["autostart"],"config":{"dfppath":"/8804/parceiros/revista_trip","isCompanion":"False","outOfPage":[],"sizeMapping":"[0, 0], [300, 50]; [320, 0], [[320, 50],[300, 50]]","forcePath":[],"nativeType":"1","bannerWidth":"320","pos":"top","expble":"1","campaignuol":"0","geolocation":"True","hide":"False","fluid":[],"isIncremental":"false","bannerId":"banner-320x50-area","bannerHeight":"50","frequencyControl":[],"group":"7,3"},"name":"DFP - Trip - 320x50"},{"module":"TailtargetTrack","rules":{"enable":["document.location.href.match(/^http(s)?:\\/\\/revistatrip\\.uol\\.com\\.br(.*)?$/)"],"disable":[]},"events":["autostart"],"config":{},"name":"Tail Target"},{"module":"ModulesInjectorAsync","rules":{"enable":["document.location.href.match(/.*/)"],"disable":[]},"events":["autostart"],"config":{"src":"//jsuol.com.br/barra/parceiro-async.js?parceiro=trip","type":"script"},"name":"Barra UOL - Topo"},{"module":"ModulesInjectorAsync","rules":{"enable":["document.location.href.match(/.*/)"],"disable":[]},"events":["autostart"],"config":{"src":"//me.jsuol.com.br/aud/revistatrip.js","type":"script"},"name":"Google Analytics - Script"}]);})(window,document);